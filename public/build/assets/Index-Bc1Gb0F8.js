import{j as e}from"./ui-D1w9Iw8H.js";import{r as d}from"./recharts-Dld1lWsf.js";import{A as J}from"./app-layout-KC_XlQnr.js";import{K as W,m as X,L as Q,S as u,t as R}from"./app-BAypecS8.js";import{T as c}from"./index-CtBsO7PD.js";import{B as r}from"./button-BntSAybs.js";import{u as Y,f as _,b as Z}from"./index-DSucgGxo.js";import{T as ee,a as se,b as v,c as ae,d as te,e as k}from"./table-HIdGJ2fv.js";import{I as f}from"./input-CYKIjOQn.js";import{D as re,a as le,b as ie,c as ne,e as ce}from"./dialog-D75RAdkD.js";import{C as P,c as F}from"./card-ujb193xZ.js";import{L as N}from"./label-BbeNXW0L.js";import{S as oe,a as me,b as de,c as xe,d as L}from"./select-Cexm_mQK.js";import{S as ue}from"./search-BGEUGtTC.js";import{R as ge}from"./refresh-cw-Sduo88Io.js";import{X as he}from"./x-CNM1Dv5p.js";import{U as pe}from"./upload-BGNQ6NBb.js";import{I as je}from"./image-BNQZrn32.js";import{S as ve}from"./square-pen-Cq7RxlXg.js";import"./react-B1hewrmX.js";import"./utils-B66yfQja.js";import"./tooltip-CQHbb0yU.js";import"./check-CkciTNW-.js";import"./createLucideIcon-CR-66RMC.js";import"./index-CWijjM2R.js";import"./index-cS_AKGRi.js";import"./index-DrdTBqzy.js";import"./chevrons-up-down-BF_I81uV.js";import"./circle-check-big-DZU7S_eA.js";import"./format-B6Rb66cG.js";function We(){var T;const{nameDevices:t,filters:B}=W().props,[b,y]=d.useState(B.search||""),[A,x]=d.useState(!1),[n,g]=d.useState(null),[S,o]=d.useState(null),[M,h]=d.useState(!1),{data:p,setData:m,post:U,processing:D,errors:l,reset:C}=X({name:"",status:"active",image:null,_method:"PUT"}),z=()=>{u.get(c("name-devices.index"),{search:b},{preserveState:!0})},H=()=>{y(""),u.get(c("name-devices.index"))},K=s=>{g(s),m({name:s.name,status:s.status||"active",image:null,_method:"PUT"}),o(s.image?`/storage/${s.image}`:null),x(!0)},$=s=>{s.preventDefault(),h(!1);const a=s.dataTransfer.files;if(a.length>0){const i=a[0];i.type.startsWith("image/")&&w(i)}},G=s=>{var i;const a=(i=s.target.files)==null?void 0:i[0];a&&w(a)},w=s=>{m("image",s);const a=new FileReader;a.onload=i=>{var E;o((E=i.target)==null?void 0:E.result)},a.readAsDataURL(s)},V=()=>{m("image",null),o(n!=null&&n.image?`/storage/${n.image}`:null);const s=document.getElementById("image");s&&(s.value="")},O=s=>{s.preventDefault(),n&&U(c("name-devices.update",n.id),{forceFormData:!0,onSuccess:()=>{R.success("Device name updated successfully"),x(!1),C(),g(null),o(null)},onError:()=>{R.error("Error updating device name")}})},q=()=>{x(!1),g(null),o(null),C()},I=[{accessorKey:"image",header:"Image",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"flex items-center justify-center",children:a.image?e.jsx("img",{src:`/storage/${a.image}`,alt:a.name,className:"w-12 h-12 rounded-lg object-cover border"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-muted flex items-center justify-center",children:e.jsx(je,{className:"w-6 h-6 text-muted-foreground"})})})}},{accessorKey:"name",header:"Name",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"font-medium",children:a.name})}},{accessorKey:"created_at",header:"Created",cell:({row:s})=>{const a=s.original;return new Date(a.created_at).toLocaleDateString()}},{id:"actions",header:"Actions",cell:({row:s})=>{const a=s.original;return e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>K(a),children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Edit"]})}}],j=Y({data:t.data,columns:I,getCoreRowModel:Z()});return e.jsxs(J,{breadcrumbs:[{title:"Device Names",href:c("name-devices.index")}],children:[e.jsx(Q,{title:"Device Names"}),e.jsxs("div",{className:"space-y-6 mx-4",children:[e.jsx(P,{children:e.jsx(F,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(f,{placeholder:"Search devices...",value:b,onChange:s=>y(s.target.value),className:"max-w-sm"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{onClick:z,children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Search"]}),e.jsxs(r,{variant:"outline",onClick:H,children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]})})}),e.jsx(P,{children:e.jsxs(F,{className:"pt-6",children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(ee,{children:[e.jsx(se,{children:j.getHeaderGroups().map(s=>e.jsx(v,{children:s.headers.map(a=>e.jsx(ae,{children:a.isPlaceholder?null:_(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(te,{children:(T=j.getRowModel().rows)!=null&&T.length?j.getRowModel().rows.map(s=>e.jsx(v,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map(a=>e.jsx(k,{children:_(a.column.columnDef.cell,a.getContext())},a.id))},s.id)):e.jsx(v,{children:e.jsx(k,{colSpan:I.length,className:"h-24 text-center",children:"No device names found."})})})]})}),t.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between space-x-2 py-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing page ",t.current_page," of ",t.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[t.current_page>1&&e.jsx(r,{variant:"outline",onClick:()=>u.get(c("name-devices.index",{page:t.current_page-1})),children:"Previous"}),t.current_page<t.last_page&&e.jsx(r,{variant:"outline",onClick:()=>u.get(c("name-devices.index",{page:t.current_page+1})),children:"Next"})]})]})]})})]}),e.jsx(re,{open:A,onOpenChange:x,children:e.jsxs(le,{className:"max-w-2xl",children:[e.jsx(ie,{children:e.jsx(ne,{children:"Edit Device Name"})}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"name",children:"Name *"}),e.jsx(f,{id:"name",type:"text",value:p.name,onChange:s=>m("name",s.target.value),placeholder:"Enter device name",className:l.name?"border-destructive":""}),l.name&&e.jsx("p",{className:"text-sm text-destructive",children:l.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"status",children:"Status *"}),e.jsxs(oe,{value:p.status,onValueChange:s=>m("status",s),children:[e.jsx(me,{children:e.jsx(de,{placeholder:"Select status"})}),e.jsxs(xe,{children:[e.jsx(L,{value:"active",children:"Active"}),e.jsx(L,{value:"inactive",children:"Inactive"})]})]}),l.status&&e.jsx("p",{className:"text-sm text-destructive",children:l.status})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{children:"Image"}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer ${M?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDrop:$,onDragOver:s=>{s.preventDefault(),h(!0)},onDragLeave:()=>h(!1),onClick:()=>{var s;return(s=document.getElementById("image"))==null?void 0:s.click()},children:[e.jsx(f,{id:"image",type:"file",accept:"image/*",onChange:G,className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full",style:{zIndex:-1}}),S?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:S,alt:"Preview",className:"max-w-full h-32 object-cover rounded-lg mx-auto"}),p.image&&e.jsx(r,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2 h-6 w-6 p-0 z-10",onClick:s=>{s.stopPropagation(),V()},children:e.jsx(he,{className:"h-3 w-3"})}),e.jsx("div",{className:"absolute inset-0  hover:bg-opacity-10 transition-colors rounded-lg flex items-center justify-center pointer-events-none",children:e.jsx("p",{className:"text-white text-sm opacity-0 hover:opacity-100 transition-opacity",children:"Click to change image"})})]}):e.jsxs("div",{className:"pointer-events-none",children:[e.jsx(pe,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Drop image here or click to select"}),e.jsx("p",{className:"text-xs text-gray-400",children:"PNG, JPG, GIF up to 2MB"})]})]}),l.image&&e.jsx("p",{className:"text-sm text-destructive",children:l.image})]})]}),e.jsxs(ce,{children:[e.jsx(r,{type:"button",variant:"outline",onClick:q,children:"Cancel"}),e.jsx(r,{type:"submit",disabled:D,children:D?"Saving...":"Save Changes"})]})]})]})})]})}export{We as default};
