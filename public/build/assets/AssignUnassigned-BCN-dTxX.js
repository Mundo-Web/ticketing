import{j as e}from"./ui-D1w9Iw8H.js";import{r as c}from"./recharts-Dld1lWsf.js";import{L as D,S as o,t as d}from"./app-BAypecS8.js";import{A as L}from"./app-layout-KC_XlQnr.js";import{C as m,a as U,b as _,c as x}from"./card-ujb193xZ.js";import{B as g}from"./button-BntSAybs.js";import{B as h}from"./format-B6Rb66cG.js";import{S as H,a as V,b as $,c as F,d as I}from"./select-Cexm_mQK.js";import{A as P}from"./arrow-left-DzZwtVMy.js";import{U as y}from"./user-plus-4uaQlw0J.js";import{T as J}from"./triangle-alert-DrKF4AKN.js";import{a as M}from"./circle-check-big-DZU7S_eA.js";import{T as R}from"./ticket-ChPWs-X9.js";import{C as q}from"./clock-BxVJL7PR.js";import{S as z}from"./smartphone-D010dtY3.js";import{U as G}from"./user-CtzshXh0.js";import{H as K}from"./house-Dzsb1MNH.js";import{B as O}from"./x-CNM1Dv5p.js";import"./react-B1hewrmX.js";import"./utils-B66yfQja.js";import"./tooltip-CQHbb0yU.js";import"./check-CkciTNW-.js";import"./createLucideIcon-CR-66RMC.js";import"./index-CWijjM2R.js";import"./index-cS_AKGRi.js";import"./index-DrdTBqzy.js";import"./chevrons-up-down-BF_I81uV.js";function be({unassignedTickets:r,technicals:C}){const[a,n]=c.useState([]),[i,p]=c.useState(""),[j,f]=c.useState(!1),N=s=>{n(t=>t.includes(s)?t.filter(l=>l!==s):[...t,s])},A=()=>{a.length===r.length?n([]):n(r.map(s=>s.id))},T=async()=>{if(!i||a.length===0){d.error("Selecciona al menos un ticket y un técnico");return}f(!0);try{for(const s of a)await new Promise((t,l)=>{o.post(`/tickets/${s}/assign-technical`,{technical_id:parseInt(i)},{preserveScroll:!0,onSuccess:()=>t(!0),onError:()=>l()})});d.success(`${a.length} ticket(s) asignado(s) correctamente`),n([]),p(""),o.reload()}catch{d.error("Error al asignar algunos tickets")}finally{f(!1)}},B=s=>new Date(s).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),E=s=>({technical:"bg-blue-100 text-blue-800",maintenance:"bg-green-100 text-green-800",repair:"bg-orange-100 text-orange-800",installation:"bg-purple-100 text-purple-800",emergency:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs(L,{children:[e.jsx(D,{title:"Asignar Tickets Sin Asignar"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-white",children:e.jsxs("div",{className:"container mx-auto px-8 py-16 space-y-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(g,{variant:"outline",onClick:()=>o.visit("/dashboard"),className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Volver al Dashboard"]})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-orange-500 to-red-500 shadow-xl",children:e.jsx(y,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-slate-900 via-orange-700 to-slate-700 bg-clip-text text-transparent",children:"Asignar Tickets Sin Asignar"}),e.jsxs("p",{className:"text-xl text-slate-600 mt-2",children:[r.length," tickets esperando asignación"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:r.length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Sin Asignar"})]})})]}),e.jsxs(m,{className:"border-0 shadow-xl bg-gradient-to-r from-white to-slate-50",children:[e.jsx(U,{children:e.jsxs(_,{className:"flex items-center gap-3",children:[e.jsx(J,{className:"h-6 w-6 text-orange-600"}),"Asignación Masiva"]})}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700",children:"Seleccionar Técnico"}),e.jsxs(H,{value:i,onValueChange:p,children:[e.jsx(V,{className:"h-12",children:e.jsx($,{placeholder:"Elige un técnico..."})}),e.jsx(F,{children:C.map(s=>e.jsx(I,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.is_default&&e.jsx(h,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:"Jefe"})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",s.shift,")"]})]})},s.id))})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(g,{onClick:A,variant:"outline",className:"h-12 w-full",children:a.length===r.length?"Deseleccionar Todo":"Seleccionar Todo"})}),e.jsx("div",{className:"flex items-end",children:e.jsx(g,{onClick:T,disabled:!i||a.length===0||j,className:"h-12 w-full bg-orange-600 hover:bg-orange-700",children:j?e.jsx(e.Fragment,{children:"Asignando..."}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Asignar ",a.length," Ticket(s)"]})})})]}),a.length>0&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-orange-800 font-medium",children:[a.length," ticket(s) seleccionado(s) para asignar"]})})]})]}),r.length===0?e.jsx(m,{className:"border-0 shadow-xl",children:e.jsxs(x,{className:"p-16 text-center",children:[e.jsx(M,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"¡Excelente trabajo!"}),e.jsx("p",{className:"text-slate-600 text-lg",children:"No hay tickets sin asignar en este momento"})]})}):e.jsx("div",{className:"grid gap-6",children:r.map(s=>{var t,l,u,v,b,w,S;return e.jsx(m,{className:`border-0 shadow-lg cursor-pointer transition-all duration-300 hover:shadow-xl hover:-translate-y-1 ${a.includes(s.id)?"ring-2 ring-orange-500 bg-orange-50":"hover:bg-slate-50"}`,onClick:()=>N(s.id),children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-orange-100",children:e.jsx(R,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:s.title}),e.jsx(h,{variant:"outline",className:"text-xs",children:s.code}),e.jsx(h,{className:E(s.category),children:s.category})]}),e.jsx("p",{className:"text-slate-600 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),B(s.created_at)]}),s.device&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),s.device.name||((t=s.device.name_device)==null?void 0:t.name)||"Dispositivo"]}),((l=s.user)==null?void 0:l.tenant)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),s.user.tenant.name]}),((v=(u=s.user)==null?void 0:u.tenant)==null?void 0:v.apartment)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),s.user.tenant.apartment.name]}),((S=(w=(b=s.user)==null?void 0:b.tenant)==null?void 0:w.apartment)==null?void 0:S.building)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),s.user.tenant.apartment.building.name]})]})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:a.includes(s.id),onChange:()=>N(s.id),className:"w-5 h-5 text-orange-600 border-gray-300 rounded focus:ring-orange-500"})})]})})},s.id)})})]})})]})}export{be as default};
