import{j as e}from"./ui-D1w9Iw8H.js";import{r as A,U as Tr}from"./recharts-Dld1lWsf.js";import{A as ls,D as os,a as is,b as ns,d as sr}from"./app-layout-DPQtw4Mn.js";import{K as cs,m as ds,L as ms,t as E,S as ne}from"./app-BKqygZAF.js";import{B as O}from"./button-BntSAybs.js";import{u as hs,T as xs,a as us,b as tr,c as ps,f as Or,d as gs,e as _r,j as fs,i as js}from"./table-Cd45YSCn.js";import{I as Ae}from"./input-CYKIjOQn.js";import{S as ar}from"./switch-CV2ctoZl.js";import{D as ce,a as de,b as me,c as he,d as xe,e as lr}from"./dialog-B7MJj1P1.js";import{L as V}from"./label-BbeNXW0L.js";import{S as Ne,a as we,b as ye,c as ke,d as F}from"./select-CxBJ8inH.js";import{a as j,b,c as v,T as or}from"./tooltip-CQHbb0yU.js";import{B as Ee}from"./format-Drb4gU7T.js";import{C as Re,c as Pe}from"./card-ujb193xZ.js";import{U as $r,F as Me,c as Ie,a as Le}from"./x-BL7C5EPd.js";import{a as ir,C as Ar}from"./circle-check-big-DZU7S_eA.js";import{T as Ce,L as bs,G as vs,a as Ns,b as ws,H as nr}from"./trophy-tcWmXr7P.js";import{T as ys}from"./trending-up-iTRTSR-d.js";import{F as ks}from"./filter-B_U0HgPW.js";import{P as Er}from"./plus-CnwexqGC.js";import{S as Cs}from"./search-BGEUGtTC.js";import{T as Ds}from"./table-BOw16QX-.js";import{R as De}from"./refresh-cw-Sduo88Io.js";import{U as ue}from"./user-CtzshXh0.js";import{T as cr}from"./triangle-alert-DrKF4AKN.js";import{M as Rr}from"./map-pin-CGVzMw_j.js";import{E as Pr}from"./external-link-DFS43cfb.js";import{C as Mr}from"./chevron-left-BbzonqSg.js";import{M as Ss,P as Ts,a as Fe,T as Os}from"./timer-5hOeDT9u.js";import{C as Ue}from"./clock-BxVJL7PR.js";import{S as _s}from"./star-XcvrnBtN.js";import{E as $s}from"./ellipsis-Dcv-ToJ_.js";import{S as dr}from"./square-pen-Cq7RxlXg.js";import{T as mr}from"./trash-2-s1GfykXA.js";import{C as As}from"./circle-alert-DMAN7II5.js";import{E as Es}from"./eye-CkkIptxE.js";import"./react-B1hewrmX.js";import"./utils-B66yfQja.js";import"./check-CkciTNW-.js";import"./createLucideIcon-CR-66RMC.js";import"./index-CWijjM2R.js";import"./index-cS_AKGRi.js";import"./index-DrdTBqzy.js";import"./chevrons-up-down-BF_I81uV.js";function H(){return H=Object.assign?Object.assign.bind():function(o){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)({}).hasOwnProperty.call(a,l)&&(o[l]=a[l])}return o},H.apply(null,arguments)}var Rs=String.prototype.replace,Ps=/%20/g,Ms="RFC3986",pe={default:Ms,formatters:{RFC1738:function(o){return Rs.call(o,Ps,"+")},RFC3986:function(o){return String(o)}},RFC1738:"RFC1738"},hr=Object.prototype.hasOwnProperty,se=Array.isArray,Q=function(){for(var o=[],t=0;t<256;++t)o.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return o}(),Ir=function(o,t){for(var a=t&&t.plainObjects?Object.create(null):{},l=0;l<o.length;++l)o[l]!==void 0&&(a[l]=o[l]);return a},Y={arrayToObject:Ir,assign:function(o,t){return Object.keys(t).reduce(function(a,l){return a[l]=t[l],a},o)},combine:function(o,t){return[].concat(o,t)},compact:function(o){for(var t=[{obj:{o},prop:"o"}],a=[],l=0;l<t.length;++l)for(var m=t[l],n=m.obj[m.prop],i=Object.keys(n),x=0;x<i.length;++x){var c=i[x],C=n[c];typeof C=="object"&&C!==null&&a.indexOf(C)===-1&&(t.push({obj:n,prop:c}),a.push(C))}return function(k){for(;k.length>1;){var g=k.pop(),y=g.obj[g.prop];if(se(y)){for(var d=[],D=0;D<y.length;++D)y[D]!==void 0&&d.push(y[D]);g.obj[g.prop]=d}}}(t),o},decode:function(o,t,a){var l=o.replace(/\+/g," ");if(a==="iso-8859-1")return l.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(l)}catch{return l}},encode:function(o,t,a,l,m){if(o.length===0)return o;var n=o;if(typeof o=="symbol"?n=Symbol.prototype.toString.call(o):typeof o!="string"&&(n=String(o)),a==="iso-8859-1")return escape(n).replace(/%u[0-9a-f]{4}/gi,function(C){return"%26%23"+parseInt(C.slice(2),16)+"%3B"});for(var i="",x=0;x<n.length;++x){var c=n.charCodeAt(x);c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||m===pe.RFC1738&&(c===40||c===41)?i+=n.charAt(x):c<128?i+=Q[c]:c<2048?i+=Q[192|c>>6]+Q[128|63&c]:c<55296||c>=57344?i+=Q[224|c>>12]+Q[128|c>>6&63]+Q[128|63&c]:(c=65536+((1023&c)<<10|1023&n.charCodeAt(x+=1)),i+=Q[240|c>>18]+Q[128|c>>12&63]+Q[128|c>>6&63]+Q[128|63&c])}return i},isBuffer:function(o){return!(!o||typeof o!="object"||!(o.constructor&&o.constructor.isBuffer&&o.constructor.isBuffer(o)))},isRegExp:function(o){return Object.prototype.toString.call(o)==="[object RegExp]"},maybeMap:function(o,t){if(se(o)){for(var a=[],l=0;l<o.length;l+=1)a.push(t(o[l]));return a}return t(o)},merge:function o(t,a,l){if(!a)return t;if(typeof a!="object"){if(se(t))t.push(a);else{if(!t||typeof t!="object")return[t,a];(l&&(l.plainObjects||l.allowPrototypes)||!hr.call(Object.prototype,a))&&(t[a]=!0)}return t}if(!t||typeof t!="object")return[t].concat(a);var m=t;return se(t)&&!se(a)&&(m=Ir(t,l)),se(t)&&se(a)?(a.forEach(function(n,i){if(hr.call(t,i)){var x=t[i];x&&typeof x=="object"&&n&&typeof n=="object"?t[i]=o(x,n,l):t.push(n)}else t[i]=n}),t):Object.keys(a).reduce(function(n,i){var x=a[i];return n[i]=hr.call(n,i)?o(n[i],x,l):x,n},m)}},Is=Object.prototype.hasOwnProperty,Lr={brackets:function(o){return o+"[]"},comma:"comma",indices:function(o,t){return o+"["+t+"]"},repeat:function(o){return o}},ae=Array.isArray,Ls=String.prototype.split,Fs=Array.prototype.push,Ur=function(o,t){Fs.apply(o,ae(t)?t:[t])},Us=Date.prototype.toISOString,Fr=pe.default,I={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Y.encode,encodeValuesOnly:!1,format:Fr,formatter:pe.formatters[Fr],indices:!1,serializeDate:function(o){return Us.call(o)},skipNulls:!1,strictNullHandling:!1},zs=function o(t,a,l,m,n,i,x,c,C,k,g,y,d,D){var $,w=t;if(typeof x=="function"?w=x(a,w):w instanceof Date?w=k(w):l==="comma"&&ae(w)&&(w=Y.maybeMap(w,function(Z){return Z instanceof Date?k(Z):Z})),w===null){if(m)return i&&!d?i(a,I.encoder,D,"key",g):a;w=""}if(typeof($=w)=="string"||typeof $=="number"||typeof $=="boolean"||typeof $=="symbol"||typeof $=="bigint"||Y.isBuffer(w)){if(i){var _=d?a:i(a,I.encoder,D,"key",g);if(l==="comma"&&d){for(var R=Ls.call(String(w),","),P="",z=0;z<R.length;++z)P+=(z===0?"":",")+y(i(R[z],I.encoder,D,"value",g));return[y(_)+"="+P]}return[y(_)+"="+y(i(w,I.encoder,D,"value",g))]}return[y(a)+"="+y(String(w))]}var q,le=[];if(w===void 0)return le;if(l==="comma"&&ae(w))q=[{value:w.length>0?w.join(",")||null:void 0}];else if(ae(x))q=x;else{var ge=Object.keys(w);q=c?ge.sort(c):ge}for(var fe=0;fe<q.length;++fe){var G=q[fe],oe=typeof G=="object"&&G.value!==void 0?G.value:w[G];if(!n||oe!==null){var He=ae(w)?typeof l=="function"?l(a,G):a:a+(C?"."+G:"["+G+"]");Ur(le,o(oe,He,l,m,n,i,x,c,C,k,g,y,d,D))}}return le},ur=Object.prototype.hasOwnProperty,Hs=Array.isArray,ze={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Y.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Vs=function(o){return o.replace(/&#(\d+);/g,function(t,a){return String.fromCharCode(parseInt(a,10))})},zr=function(o,t){return o&&typeof o=="string"&&t.comma&&o.indexOf(",")>-1?o.split(","):o},qs=function(o,t,a,l){if(o){var m=a.allowDots?o.replace(/\.([^.[]+)/g,"[$1]"):o,n=/(\[[^[\]]*])/g,i=a.depth>0&&/(\[[^[\]]*])/.exec(m),x=i?m.slice(0,i.index):m,c=[];if(x){if(!a.plainObjects&&ur.call(Object.prototype,x)&&!a.allowPrototypes)return;c.push(x)}for(var C=0;a.depth>0&&(i=n.exec(m))!==null&&C<a.depth;){if(C+=1,!a.plainObjects&&ur.call(Object.prototype,i[1].slice(1,-1))&&!a.allowPrototypes)return;c.push(i[1])}return i&&c.push("["+m.slice(i.index)+"]"),function(k,g,y,d){for(var D=d?g:zr(g,y),$=k.length-1;$>=0;--$){var w,_=k[$];if(_==="[]"&&y.parseArrays)w=[].concat(D);else{w=y.plainObjects?Object.create(null):{};var R=_.charAt(0)==="["&&_.charAt(_.length-1)==="]"?_.slice(1,-1):_,P=parseInt(R,10);y.parseArrays||R!==""?!isNaN(P)&&_!==R&&String(P)===R&&P>=0&&y.parseArrays&&P<=y.arrayLimit?(w=[])[P]=D:R!=="__proto__"&&(w[R]=D):w={0:D}}D=w}return D}(c,t,a,l)}},Bs=function(o,t){var a=function(C){return ze}();if(o===""||o==null)return a.plainObjects?Object.create(null):{};for(var l=typeof o=="string"?function(C,k){var g,y={},d=(k.ignoreQueryPrefix?C.replace(/^\?/,""):C).split(k.delimiter,k.parameterLimit===1/0?void 0:k.parameterLimit),D=-1,$=k.charset;if(k.charsetSentinel)for(g=0;g<d.length;++g)d[g].indexOf("utf8=")===0&&(d[g]==="utf8=%E2%9C%93"?$="utf-8":d[g]==="utf8=%26%2310003%3B"&&($="iso-8859-1"),D=g,g=d.length);for(g=0;g<d.length;++g)if(g!==D){var w,_,R=d[g],P=R.indexOf("]="),z=P===-1?R.indexOf("="):P+1;z===-1?(w=k.decoder(R,ze.decoder,$,"key"),_=k.strictNullHandling?null:""):(w=k.decoder(R.slice(0,z),ze.decoder,$,"key"),_=Y.maybeMap(zr(R.slice(z+1),k),function(q){return k.decoder(q,ze.decoder,$,"value")})),_&&k.interpretNumericEntities&&$==="iso-8859-1"&&(_=Vs(_)),R.indexOf("[]=")>-1&&(_=Hs(_)?[_]:_),y[w]=ur.call(y,w)?Y.combine(y[w],_):_}return y}(o,a):o,m=a.plainObjects?Object.create(null):{},n=Object.keys(l),i=0;i<n.length;++i){var x=n[i],c=qs(x,l[x],a,typeof o=="string");m=Y.merge(m,c,a)}return Y.compact(m)};class xr{constructor(t,a,l){var m,n;this.name=t,this.definition=a,this.bindings=(m=a.bindings)!=null?m:{},this.wheres=(n=a.wheres)!=null?n:{},this.config=l}get template(){const t=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return t===""?"/":t}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var t,a;return(t=(a=this.template.match(/{[^}?]+\??}/g))==null?void 0:a.map(l=>({name:l.replace(/{|\??}/g,""),required:!/\?}$/.test(l)})))!=null?t:[]}matchesUrl(t){var a;if(!this.definition.methods.includes("GET"))return!1;const l=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(x,c,C,k)=>{var g;const y=`(?<${C}>${((g=this.wheres[C])==null?void 0:g.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return k?`(${c}${y})?`:`${c}${y}`}).replace(/^\w+:\/\//,""),[m,n]=t.replace(/^\w+:\/\//,"").split("?"),i=(a=new RegExp(`^${l}/?$`).exec(m))!=null?a:new RegExp(`^${l}/?$`).exec(decodeURI(m));if(i){for(const x in i.groups)i.groups[x]=typeof i.groups[x]=="string"?decodeURIComponent(i.groups[x]):i.groups[x];return{params:i.groups,query:Bs(n)}}return!1}compile(t){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(a,l,m)=>{var n,i;if(!m&&[null,void 0].includes(t[l]))throw new Error(`Ziggy error: '${l}' parameter is required for route '${this.name}'.`);if(this.wheres[l]&&!new RegExp(`^${m?`(${this.wheres[l]})?`:this.wheres[l]}$`).test((i=t[l])!=null?i:""))throw new Error(`Ziggy error: '${l}' parameter '${t[l]}' does not match required format '${this.wheres[l]}' for route '${this.name}'.`);return encodeURI((n=t[l])!=null?n:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class Qs extends String{constructor(t,a,l=!0,m){if(super(),this.t=m??(typeof Ziggy<"u"?Ziggy:globalThis==null?void 0:globalThis.Ziggy),this.t=H({},this.t,{absolute:l}),t){if(!this.t.routes[t])throw new Error(`Ziggy error: route '${t}' is not in the route list.`);this.i=new xr(t,this.t.routes[t],this.t),this.u=this.l(a)}}toString(){const t=Object.keys(this.u).filter(a=>!this.i.parameterSegments.some(({name:l})=>l===a)).filter(a=>a!=="_query").reduce((a,l)=>H({},a,{[l]:this.u[l]}),{});return this.i.compile(this.u)+function(a,l){var m,n=a,i=function(d){if(!d)return I;if(d.encoder!=null&&typeof d.encoder!="function")throw new TypeError("Encoder has to be a function.");var D=d.charset||I.charset;if(d.charset!==void 0&&d.charset!=="utf-8"&&d.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var $=pe.default;if(d.format!==void 0){if(!Is.call(pe.formatters,d.format))throw new TypeError("Unknown format option provided.");$=d.format}var w=pe.formatters[$],_=I.filter;return(typeof d.filter=="function"||ae(d.filter))&&(_=d.filter),{addQueryPrefix:typeof d.addQueryPrefix=="boolean"?d.addQueryPrefix:I.addQueryPrefix,allowDots:d.allowDots===void 0?I.allowDots:!!d.allowDots,charset:D,charsetSentinel:typeof d.charsetSentinel=="boolean"?d.charsetSentinel:I.charsetSentinel,delimiter:d.delimiter===void 0?I.delimiter:d.delimiter,encode:typeof d.encode=="boolean"?d.encode:I.encode,encoder:typeof d.encoder=="function"?d.encoder:I.encoder,encodeValuesOnly:typeof d.encodeValuesOnly=="boolean"?d.encodeValuesOnly:I.encodeValuesOnly,filter:_,format:$,formatter:w,serializeDate:typeof d.serializeDate=="function"?d.serializeDate:I.serializeDate,skipNulls:typeof d.skipNulls=="boolean"?d.skipNulls:I.skipNulls,sort:typeof d.sort=="function"?d.sort:null,strictNullHandling:typeof d.strictNullHandling=="boolean"?d.strictNullHandling:I.strictNullHandling}}(l);typeof i.filter=="function"?n=(0,i.filter)("",n):ae(i.filter)&&(m=i.filter);var x=[];if(typeof n!="object"||n===null)return"";var c=Lr[l&&l.arrayFormat in Lr?l.arrayFormat:l&&"indices"in l?l.indices?"indices":"repeat":"indices"];m||(m=Object.keys(n)),i.sort&&m.sort(i.sort);for(var C=0;C<m.length;++C){var k=m[C];i.skipNulls&&n[k]===null||Ur(x,zs(n[k],k,c,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset))}var g=x.join(i.delimiter),y=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(y+=i.charset==="iso-8859-1"?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),g.length>0?y+g:""}(H({},t,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(a,l)=>typeof a=="boolean"?Number(a):l(a)})}p(t){t?this.t.absolute&&t.startsWith("/")&&(t=this.h().host+t):t=this.v();let a={};const[l,m]=Object.entries(this.t.routes).find(([n,i])=>a=new xr(n,i,this.t).matchesUrl(t))||[void 0,void 0];return H({name:l},a,{route:m})}v(){const{host:t,pathname:a,search:l}=this.h();return(this.t.absolute?t+a:a.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+l}current(t,a){const{name:l,params:m,query:n,route:i}=this.p();if(!t)return l;const x=new RegExp(`^${t.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(l);if([null,void 0].includes(a)||!x)return x;const c=new xr(l,i,this.t);a=this.l(a,c);const C=H({},m,n);if(Object.values(a).every(g=>!g)&&!Object.values(C).some(g=>g!==void 0))return!0;const k=(g,y)=>Object.entries(g).every(([d,D])=>Array.isArray(D)&&Array.isArray(y[d])?D.every($=>y[d].includes($)):typeof D=="object"&&typeof y[d]=="object"&&D!==null&&y[d]!==null?k(D,y[d]):y[d]==D);return k(a,C)}h(){var t,a,l,m,n,i;const{host:x="",pathname:c="",search:C=""}=typeof window<"u"?window.location:{};return{host:(t=(a=this.t.location)==null?void 0:a.host)!=null?t:x,pathname:(l=(m=this.t.location)==null?void 0:m.pathname)!=null?l:c,search:(n=(i=this.t.location)==null?void 0:i.search)!=null?n:C}}get params(){const{params:t,query:a}=this.p();return H({},t,a)}get routeParams(){return this.p().params}get queryParams(){return this.p().query}has(t){return this.t.routes.hasOwnProperty(t)}l(t={},a=this.i){t!=null||(t={}),t=["string","number"].includes(typeof t)?[t]:t;const l=a.parameterSegments.filter(({name:m})=>!this.t.defaults[m]);return Array.isArray(t)?t=t.reduce((m,n,i)=>H({},m,l[i]?{[l[i].name]:n}:typeof n=="object"?n:{[n]:""}),{}):l.length!==1||t[l[0].name]||!t.hasOwnProperty(Object.values(a.bindings)[0])&&!t.hasOwnProperty("id")||(t={[l[0].name]:t}),H({},this.m(a),this.j(t,a))}m(t){return t.parameterSegments.filter(({name:a})=>this.t.defaults[a]).reduce((a,{name:l},m)=>H({},a,{[l]:this.t.defaults[l]}),{})}j(t,{bindings:a,parameterSegments:l}){return Object.entries(t).reduce((m,[n,i])=>{if(!i||typeof i!="object"||Array.isArray(i)||!l.some(({name:x})=>x===n))return H({},m,{[n]:i});if(!i.hasOwnProperty(a[n])){if(!i.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${n}' parameter is missing route model binding key '${a[n]}'.`);a[n]="id"}return H({},m,{[n]:i[a[n]]})},{})}valueOf(){return this.toString()}}function te(o,t,a,l){const m=new Qs(o,t,a,l);return o?m.toString():m}const M=({value:o,duration:t=1e3})=>{const[a,l]=Tr.useState(0);return Tr.useEffect(()=>{let m,n;const i=x=>{m||(m=x);const c=Math.min((x-m)/t,1),C=1-Math.pow(1-c,3),k=Math.floor(C*o);l(k),c<1&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{n&&cancelAnimationFrame(n)}},[o,t]),e.jsx("span",{children:a})};function Lt({technicals:o,filters:t,canManage:a,isDefaultTechnical:l,isSuperAdmin:m}){var kr,Cr,Dr;const{auth:n}=cs().props,i=((kr=n==null?void 0:n.user)==null?void 0:kr.roles)||[],x=m??(Array.isArray(i)?i.includes("super-admin"):!1);console.log("User roles:",i);const c=r=>!!r.is_default,C=r=>{switch(r){case"open":return"bg-red-100 text-red-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},k=r=>new Date(r).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),g=async(r,s)=>{const S={all:"All Tickets",today:"Today's Tickets",week:"This Week's Tickets",month:"This Month's Tickets",recent:"Recent Completed Tickets (Last 7 days)",open:"Open Tickets",in_progress:"In Progress Tickets",resolved:"Resolved Tickets",closed:"Closed Tickets"};Vr(`${r.name} - ${S[s]}`),jr(!0),oe(!0);try{const u=await fetch(`/api/technicals/${r.id}/tickets?type=${s}`);if(u.ok){const N=await u.json();Ve(N)}else{let N=r.tickets||[];switch(s){case"open":{N=N.filter(h=>h.status==="open");break}case"in_progress":{N=N.filter(h=>h.status==="in_progress");break}case"resolved":{N=N.filter(h=>h.status==="resolved");break}case"closed":{N=N.filter(h=>h.status==="closed");break}case"today":{const h=new Date;h.setHours(0,0,0,0);const p=new Date(h);p.setDate(h.getDate()+1),N=N.filter(T=>{const U=new Date(T.created_at);return U>=h&&U<p});break}case"week":{const h=new Date,p=new Date(h);p.setDate(h.getDate()-h.getDay()),p.setHours(0,0,0,0),N=N.filter(T=>new Date(T.created_at)>=p);break}case"month":{const h=new Date,p=new Date(h.getFullYear(),h.getMonth(),1);N=N.filter(T=>new Date(T.created_at)>=p);break}case"recent":{const h=new Date;h.setDate(h.getDate()-7),h.setHours(0,0,0,0),N=N.filter(p=>new Date(p.created_at)>=h&&["resolved","closed"].includes(p.status));break}default:break}Ve(N)}}catch(u){console.log("Using local tickets data:",u),E.error("Could not fetch latest ticket data, showing local data");let N=r.tickets||[];switch(s){case"open":N=N.filter(h=>h.status==="open");break;case"in_progress":N=N.filter(h=>h.status==="in_progress");break;case"resolved":N=N.filter(h=>h.status==="resolved");break;case"closed":N=N.filter(h=>h.status==="closed");break;case"today":{const h=new Date;h.setHours(0,0,0,0);const p=new Date(h);p.setDate(h.getDate()+1),N=N.filter(T=>{const U=new Date(T.created_at);return U>=h&&U<p});break}case"week":{const h=new Date,p=new Date(h);p.setDate(h.getDate()-h.getDay()),p.setHours(0,0,0,0),N=N.filter(T=>new Date(T.created_at)>=p);break}case"month":{const h=new Date,p=new Date(h.getFullYear(),h.getMonth(),1);N=N.filter(T=>new Date(T.created_at)>=p);break}case"recent":{const h=new Date;h.setDate(h.getDate()-7),h.setHours(0,0,0,0),N=N.filter(p=>new Date(p.created_at)>=h&&["resolved","closed"].includes(p.status));break}}Ve(N)}finally{jr(!1)}},y=async r=>{gr(!0),Z(!0);try{const s=await fetch(`/api/tickets/${r}/detail`);if(s.ok){const S=await s.json();qe(S)}else{const S={id:r,title:"Sample Ticket",description:"This is a sample ticket description with technical details...",status:"in_progress",priority:"high",category:"Hardware",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),history:[{id:1,action:"Ticket Created",description:"Ticket was created by tenant",created_at:new Date().toISOString(),user:{name:"System",role:"system"}}],comments:[]};qe(S)}}catch{E.error("Error loading ticket details")}finally{gr(!1)}},[d,D]=A.useState("list"),[$,w]=A.useState(!1),[_,R]=A.useState(!1),[P,z]=A.useState(null),[q,le]=A.useState(null),[ge,fe]=A.useState(4),[G,oe]=A.useState(!1),[He,Z]=A.useState(!1),[W,Ve]=A.useState([]),[f,qe]=A.useState(null),[Hr,Vr]=A.useState(""),[J,Be]=A.useState(""),[X,Qe]=A.useState("all"),[ie,Ge]=A.useState("all"),[pr,qr]=A.useState(!1),[Br,gr]=A.useState(!1),[fr,jr]=A.useState(!1),[Qr,Se]=A.useState(!1),[B,br]=A.useState(null),[ee,Te]=A.useState({instruction:"",priority:"normal"}),[Ke,vr]=A.useState(!1),K=r=>!r||r==="null"||r.trim()===""?null:`/storage/${r}`,je=o.data.filter(r=>{const s=r.name.toLowerCase().includes(J.toLowerCase())||r.email.toLowerCase().includes(J.toLowerCase())||r.phone.includes(J),S=X==="all"||X==="active"&&r.status||X==="inactive"&&!r.status,u=ie==="all"||r.shift===ie;return s&&S&&u}),[Gr,be]=A.useState(!1),[Kr,Oe]=A.useState(!1),[Ye,_e]=A.useState(null),{data:L,setData:re,delete:Yr,processing:Nr,reset:Zr}=ds({id:null,name:"",email:"",phone:"",shift:"morning",photo:null}),ve=(r,s)=>{switch(r){case"name":case"email":case"phone":re(r,s);break;case"shift":re(r,s);break;case"photo":re(r,s);break;case"id":re(r,s);break}if(Ye){const S={...L,[r]:s},u=Object.keys(Ye).some(N=>{const h=N;return h==="photo"?S[h]!==null:Ye[h]!==S[h]});be(u)}},wr=()=>{Gr?Oe(!0):$e()},$e=()=>{w(!1),Oe(!1),be(!1),_e(null),Zr()},Wr=()=>{$e()},yr=[{accessorKey:"photo",header:"Photo",cell:({row:r})=>e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:K(r.original.photo)?e.jsx("img",{src:K(r.original.photo),alt:r.original.name,className:"w-full h-full object-cover",onError:s=>{const S=s.target;S.style.display="none",S.parentElement.innerHTML='<div class="w-full h-full bg-gray-200 flex items-center justify-center"><User size={16} class="text-gray-500" /></div>'}}):e.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-gray-400"})})})},{accessorKey:"name",header:"Name"},{accessorKey:"email",header:"Email"},{accessorKey:"phone",header:"Phone"},{accessorKey:"shift",header:"Shift",cell:({row:r})=>e.jsx("span",{className:"capitalize",children:r.original.shift})},{accessorKey:"is_default",header:"Role",cell:({row:r})=>e.jsx("div",{className:"flex items-center gap-2",children:x?e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{variant:c(r.original)?"default":"outline",size:"sm",onClick:()=>Je(r.original),className:"h-6 px-2 text-xs",children:c(r.original)?"Remove Chief":"Set as Chief"})}),e.jsxs(v,{children:[e.jsxs("p",{children:[c(r.original)?"Remove as":"Set as"," Tech Default"]}),e.jsx("p",{children:"Tech Defaults have additional permissions"})]})]}):e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${c(r.original)?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:c(r.original)?"Tech Default":"Technical"})})},{accessorKey:"status",header:"Status",cell:({row:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(ar,{checked:r.original.status,onCheckedChange:()=>We(r.original),disabled:q===r.original.id})}),e.jsx(v,{children:e.jsxs("p",{children:[r.original.status?"Deactivate":"Activate"," technical"]})})]}),e.jsx(Gs,{status:r.original.status?"active":"inactive"})]})},{id:"actions",header:"Actions",cell:({row:r})=>e.jsxs(os,{children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(is,{asChild:!0,children:e.jsx(O,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx($s,{className:"h-4 w-4"})})})}),e.jsx(v,{children:e.jsx("p",{children:"More actions"})})]}),e.jsxs(ns,{align:"end",children:[e.jsxs(sr,{onClick:()=>Xe(r.original),children:[e.jsx(dr,{className:"mr-2 h-4 w-4"}),"Edit"]}),x&&e.jsxs(sr,{onClick:()=>rr(r.original),children:[e.jsx(De,{className:"mr-2 h-4 w-4 text-orange-600"}),"Reset Password"]}),e.jsxs(sr,{onClick:()=>er(r.original),children:[e.jsx(mr,{className:"mr-2 h-4 w-4 text-destructive"}),"Delete"]})]})]})}],Ze=hs({data:je,columns:yr,getCoreRowModel:js(),getPaginationRowModel:fs()}),Jr=({technicals:r,gridColumns:s})=>{const S=()=>{switch(s){case 2:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-2";case 3:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-3";case 4:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-4";case 5:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-5";case 6:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-6";default:return"grid-cols-1 md:grid-cols-2 lg:grid-cols-4"}};return e.jsx(or,{children:e.jsx("div",{className:`grid ${S()} gap-6`,children:r.map((u,N)=>e.jsxs("div",{className:"bg-gradient-to-br from-white to-corporate-gold/5 dark:from-dark-brown dark:to-corporate-gold/10 p-4 rounded-xl shadow-sm transition-all duration-500 border-2 border-corporate-gold/20 relative overflow-hidden",style:{animationDelay:`${N*150}ms`,animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-br from-corporate-gold/20 to-transparent rounded-bl-2xl opacity-50"}),e.jsx("div",{className:"w-full aspect-square rounded-lg overflow-hidden mb-4 border-2 border-corporate-gold/30 transition-all duration-300 relative",children:K(u.photo)?e.jsx("img",{src:K(u.photo),alt:u.name,className:"w-full h-full object-cover",onError:h=>{h.currentTarget.src="/images/default-user.png"}}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-corporate-gold/10 to-corporate-warm/10 flex items-center justify-center",children:e.jsx(ue,{className:"w-16 h-16 text-corporate-gold/60"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx("h3",{className:"font-semibold text-xl truncate text-corporate-gold dark:text-corporate-gold-light transition-colors duration-300 cursor-help",children:u.name})}),e.jsxs(v,{children:[e.jsxs("p",{children:["Technical: ",u.name]}),e.jsxs("p",{children:["Email: ",u.email]}),e.jsxs("p",{children:["Phone: ",u.phone]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(ar,{checked:u.status,onCheckedChange:()=>We(u),disabled:q===u.id,className:"scale-90 data-[state=checked]:bg-corporate-gold"})}),e.jsx(v,{children:e.jsxs("p",{children:[u.status?"Deactivate":"Activate"," technical"]})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"text-muted-foreground truncate",children:u.email}),e.jsx("p",{className:"font-medium text-corporate-dark-brown dark:text-corporate-gold-light",children:u.phone}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`capitalize text-white px-3 py-1 rounded-md font-medium transition-all duration-300 ${u.shift==="morning"?"bg-gradient-to-r from-corporate-gold to-corporate-warm shadow-lg shadow-corporate-gold/30":u.shift==="afternoon"?"bg-gradient-to-r from-corporate-warm to-corporate-gold shadow-lg shadow-corporate-warm/30":"bg-gradient-to-r from-corporate-dark-brown to-corporate-brown shadow-lg shadow-corporate-dark-brown/30"}`,children:u.shift}),c(u)&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx("span",{className:"bg-gradient-to-r from-corporate-gold via-corporate-warm to-corporate-gold text-white px-2 py-1 rounded-md text-xs font-medium animate-pulse shadow-lg cursor-help",children:"Tech Default"})}),e.jsxs(v,{children:[e.jsx("p",{children:"Technical Chief - Team Leader"}),e.jsx("p",{children:"Has special permissions and responsibilities"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(u,"month"),className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-2 rounded-lg border border-purple-200 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:e.jsx(M,{value:u.monthly_tickets})}),e.jsx("div",{className:"text-xs text-purple-600",children:"Month"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view this month's tickets"}),e.jsxs("p",{children:[u.monthly_tickets," tickets this month"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(u,"week"),className:"bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 p-2 rounded-lg border border-corporate-gold/30 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-lg font-bold text-corporate-gold",children:e.jsx(M,{value:u.weekly_tickets})}),e.jsx("div",{className:"text-xs text-corporate-gold",children:"Week"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view this week's tickets"}),e.jsxs("p",{children:[u.weekly_tickets," tickets this week"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(u,"today"),className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-2 rounded-lg border border-green-200 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:e.jsx(M,{value:u.today_tickets})}),e.jsx("div",{className:"text-xs text-green-600",children:"Today"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view today's tickets"}),e.jsxs("p",{children:[u.today_tickets," tickets today"]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>Xe(u),variant:"outline",size:"sm",className:"gap-2 px-4 border-corporate-gold/30 transition-all duration-300",children:e.jsx(dr,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsx("p",{children:"Edit technical information"})})]}),x&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>rr(u),variant:"outline",size:"sm",className:"gap-2 px-4 border-orange-300 transition-all duration-300",children:e.jsx(De,{className:"w-4 h-4"})})}),e.jsxs(v,{children:[e.jsx("p",{children:"Reset password to email"}),e.jsx("p",{className:"text-orange-500",children:"Password will be set to their email"})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>er(u),variant:"outline",size:"sm",className:"gap-2 px-4 border-red-300 transition-all duration-300",children:e.jsx(mr,{className:"w-4 h-4"})})}),e.jsxs(v,{children:[e.jsx("p",{children:"Delete technical permanently"}),e.jsx("p",{className:"text-red-500",children:"This action cannot be undone"})]})]})]}),x&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{onClick:()=>Je(u),variant:c(u)?"default":"outline",size:"sm",className:`text-xs transition-all duration-300 ${c(u)?"bg-gradient-to-r from-corporate-gold to-corporate-warm text-white shadow-lg":"border-corporate-gold/30"}`,children:[e.jsx(Ce,{className:"w-4 h-4 mr-1"}),c(u)?"Remove Chief":"Set as Chief"]})}),e.jsxs(v,{children:[e.jsxs("p",{children:[c(u)?"Remove as":"Set as"," Tech Default"]}),e.jsx("p",{children:"Tech Defaults have additional permissions"})]})]})]})]})]},u.id))})})},Xr=({technicals:r})=>e.jsx(or,{children:e.jsx("div",{className:"space-y-6",children:r.map((s,S)=>{var u,N,h;return e.jsxs("div",{className:"bg-gradient-to-r from-white to-corporate-gold/5 dark:from-transparent dark:to-corporate-gold/10 rounded-xl shadow-sm transition-all duration-500 border-2 border-corporate-gold/20 overflow-hidden group",style:{animationDelay:`${S*200}ms`,animation:"fadeInUp 0.8s ease-out forwards"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-corporate-gold/0 via-corporate-gold/5 to-corporate-gold/0 opacity-0 transition-opacity duration-700 pointer-events-none"}),e.jsxs("div",{className:"flex relative z-10",children:[e.jsxs("div",{className:"w-80 bg-gradient-to-br from-corporate-gold/10 to-corporate-warm/10 dark:from-corporate-gold/20 dark:to-corporate-warm/20 p-6 border-r border-corporate-gold/20 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-corporate-gold/20 to-transparent rounded-bl-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 bg-gradient-to-tr from-corporate-warm/20 to-transparent rounded-tr-3xl"}),e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4 relative z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-corporate-gold/30 shadow-xl relative transition-transform duration-500",children:K(s.photo)?e.jsx("img",{src:K(s.photo),alt:s.name,className:"w-full h-full object-cover",onError:p=>{p.currentTarget.src="/images/default-user.png"}}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 flex items-center justify-center",children:e.jsx(ue,{className:"w-12 h-12 text-corporate-gold"})})}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-corporate-gold/0 transition-all duration-500"}),c(s)&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-r from-corporate-gold to-corporate-warm rounded-full p-2 shadow-lg animate-bounce",children:e.jsx(Ce,{className:"w-4 h-4 text-primary-foreground dark:text-white"})})}),e.jsx(v,{children:e.jsx("p",{children:"Technical Chief - Team Leader"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-bold text-xl text-corporate-gold dark:text-corporate-gold-light transition-colors duration-300",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),e.jsx("p",{className:"font-medium text-corporate-dark-brown dark:text-corporate-gold-light",children:s.phone}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium capitalize shadow-lg transition-all duration-300  ${s.shift==="morning"?"bg-gradient-to-r from-corporate-gold to-corporate-warm text-primary-foregrounde shadow-corporate-gold/30":s.shift==="afternoon"?"bg-gradient-to-r from-corporate-warm to-corporate-gold text-primary-foreground shadow-corporate-warm/30":"bg-gradient-to-r from-corporate-dark-brown to-corporate-brown text-primary-foreground shadow-corporate-dark-brown/30"}`,children:[e.jsx(Ue,{className:"w-3 h-3 mr-1"}),s.shift]}),c(s)&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 dark:text-white rounded-full text-xs font-medium bg-gradient-to-r from-corporate-gold via-corporate-warm to-corporate-gold text-primary-foreground shadow-lg",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),"Tech Default"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"bg-white/70 dark:bg-transparent dark:bg-corporate-gold/10 p-2 rounded-lg border border-corporate-gold/20 text-center transition-colors duration-300 cursor-pointer",children:[e.jsx("div",{className:"text-lg font-bold text-corporate-gold animate-pulse",children:e.jsx(M,{value:s.current_streak})}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Streak"})]})}),e.jsx(v,{children:e.jsx("p",{children:"Consecutive resolved tickets"})})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"bg-white/70 dark:bg-transparent p-2 rounded-lg border border-corporate-gold/20 text-center transition-colors duration-300 cursor-pointer",children:[e.jsxs("div",{className:"text-lg font-bold text-corporate-warm",children:[e.jsx(M,{value:s.avg_resolution_time}),"h"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg Time"})]})}),e.jsx(v,{children:e.jsx("p",{children:"Average resolution time in hours"})})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`px-2 py-1 flex gap-2 items-center rounded-full text-xs font-medium transition-all duration-300 ${s.status?"bg-gradient-to-r from-green-100 to-green-200 text-green-800 shadow-green-200/50":"bg-gradient-to-r from-red-100 to-red-200 text-red-800 shadow-red-200/50"}`,children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(ar,{checked:s.status,onCheckedChange:()=>We(s),disabled:q===s.id,className:"data-[state=checked]:bg-white data-[state=unchecked]:bg-gray-200"})}),e.jsx(v,{children:e.jsxs("p",{children:[s.status?"Deactivate":"Activate"," technical"]})})]}),s.status?"Active":"Inactive"]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>Xe(s),variant:"outline",size:"sm",className:"flex-1 border-corporate-gold/30 transition-colors duration-300",children:e.jsx(dr,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsx("p",{children:"Edit technical information"})})]}),x&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>rr(s),variant:"outline",size:"sm",className:"flex-1 border-orange-300 transition-colors duration-300",children:e.jsx(De,{className:"w-4 h-4"})})}),e.jsxs(v,{children:[e.jsx("p",{children:"Reset password to email"}),e.jsx("p",{className:"text-orange-500",children:"Password will be set to their email"})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>er(s),variant:"outline",size:"sm",className:"flex-1 border-red-300 transition-colors duration-300",children:e.jsx(mr,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsx("p",{children:"Delete technical permanently"})})]}),x&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>Je(s),variant:c(s)?"default":"outline",size:"sm",className:`flex-1 transition-colors duration-300 ${c(s)?"bg-secondary text-primary-foreground border-corporate-gold":"border-corporate-gold/30"}`,children:e.jsx(Ce,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsxs("p",{children:[c(s)?"Remove as":"Set as"," Tech Default"]})})]}),(x||i.includes("technical"))&&e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{onClick:()=>es(s),variant:"outline",size:"sm",className:"flex-1 border-blue-300 hover:bg-blue-50 transition-colors duration-300",children:e.jsx(Fe,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsx("p",{children:"Send instruction to technical"})})]})]})]})]}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ws,{className:"w-5 h-5 text-corporate-gold"}),e.jsx("h4",{className:"font-semibold text-lg text-corporate-gold dark:text-corporate-gold-light",children:"Performance Metrics"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"today"),className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-3 rounded-lg border border-green-200 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:e.jsx(M,{value:s.today_tickets})}),e.jsx("div",{className:"text-xs text-green-600",children:"Today"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view today's tickets"}),e.jsxs("p",{children:[s.today_tickets," tickets created today"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"week"),className:"bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 p-3 rounded-lg border border-corporate-gold/30 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-xl font-bold text-corporate-gold",children:e.jsx(M,{value:s.weekly_tickets})}),e.jsx("div",{className:"text-xs text-corporate-gold",children:"This Week"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view this week's tickets"}),e.jsxs("p",{children:[s.weekly_tickets," tickets this week"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"month"),className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-3 rounded-lg border border-purple-200 text-center transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsx("div",{className:"text-xl font-bold text-purple-600",children:e.jsx(M,{value:s.monthly_tickets})}),e.jsx("div",{className:"text-xs text-purple-600",children:"This Month"})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view this month's tickets"}),e.jsxs("p",{children:[s.monthly_tickets," tickets this month"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"open"),className:"flex items-center justify-between p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(As,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Open Tickets"}),e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Require immediate attention"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-red-600",children:e.jsx(M,{value:s.open_tickets})}),e.jsx(Le,{className:"w-4 h-4 text-red-500"})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view all open tickets"}),e.jsxs("p",{children:[s.open_tickets," tickets waiting for work to begin"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"in_progress"),className:"flex items-center justify-between p-3 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ue,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:"In Progress"}),e.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Currently being worked on"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-yellow-600",children:e.jsx(M,{value:s.in_progress_tickets})}),e.jsx(Le,{className:"w-4 h-4 text-yellow-500"})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view all tickets in progress"}),e.jsxs("p",{children:[s.in_progress_tickets," tickets actively being resolved"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"resolved"),className:"flex items-center justify-between p-3 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ir,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Resolved"}),e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Successfully completed"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-green-600",children:e.jsx(M,{value:s.resolved_tickets})}),e.jsx(Le,{className:"w-4 h-4 text-green-500"})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view all resolved tickets"}),e.jsxs("p",{children:[s.resolved_tickets," tickets successfully completed"]})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>g(s,"recent"),className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 transition-all duration-300 cursor-pointer hover:scale-105 transform",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(nr,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Recent Completed"}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Last 7 days (resolved/closed only)"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:e.jsx(M,{value:((u=s.tickets)==null?void 0:u.filter(p=>{const T=new Date;return T.setDate(T.getDate()-7),new Date(p.created_at)>=T&&["resolved","closed"].includes(p.status)}).length)||0})}),e.jsx(Le,{className:"w-4 h-4 text-blue-500"})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view recent completed tickets"}),e.jsx("p",{children:"Shows only resolved/closed tickets from last 7 days"}),e.jsx("p",{className:"text-blue-500",children:"Excludes active (open/in progress) tickets"})]})]})]}),s.total_tickets>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-corporate-gold font-medium",children:"Success Rate"}),e.jsxs("span",{className:"font-bold text-corporate-gold",children:[e.jsx(M,{value:Math.round(s.resolved_tickets/s.total_tickets*100)}),"%"]})]}),e.jsx("div",{className:"w-full bg-gradient-to-r from-gray-200 to-gray-300 rounded-full h-3 shadow-inner overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-corporate-gold via-corporate-warm to-corporate-gold h-3 rounded-full transition-all duration-2000 ease-out shadow-lg relative",style:{width:`${Math.round(s.resolved_tickets/s.total_tickets*100)}%`,animationDelay:`${S*300}ms`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"})})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-3 border-t border-corporate-gold/20",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"text-center p-2 rounded-lg bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border border-green-200 transition-colors duration-300 cursor-pointer hover:bg-gradient-to-br hover:from-green-100 hover:to-green-150",children:[e.jsx("div",{className:"text-sm font-medium text-green-600",children:"Resolved Today"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:e.jsx(M,{value:s.resolved_today})})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Tickets resolved today"}),e.jsx("p",{children:"Shows completion performance for today"})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"text-center p-2 rounded-lg bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 border border-corporate-gold/30 transition-colors duration-300 cursor-pointer hover:bg-gradient-to-br hover:from-corporate-gold/30 hover:to-corporate-warm/30",children:[e.jsx("div",{className:"text-sm font-medium text-corporate-gold",children:"Avg Resolution"}),e.jsxs("div",{className:"text-lg font-bold text-corporate-gold",children:[e.jsx(M,{value:s.avg_resolution_time}),"h"]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Average time to resolve tickets"}),e.jsx("p",{children:"Lower is better for efficiency"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ie,{className:"w-5 h-5 text-corporate-gold"}),e.jsx("h4",{className:"font-semibold text-lg text-corporate-gold dark:text-corporate-gold-light",children:"Active Assignments"}),e.jsx("span",{className:"bg-gradient-to-r from-corporate-gold/20 to-corporate-warm/20 text-corporate-gold border border-corporate-gold/30 px-2 py-1 rounded-full text-xs font-medium animate-pulse",children:e.jsx(M,{value:s.assigned_devices_count})})]}),e.jsx("div",{className:"space-y-2 max-h-36 overflow-y-auto overflow-x-hidden",children:((N=s.assigned_devices)==null?void 0:N.length)>0?s.assigned_devices.map((p,T)=>{var U,Sr;return e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 p-3 rounded-lg border border-corporate-gold/20 hover:bg-gradient-to-r hover:from-corporate-gold/10 hover:to-corporate-warm/10 hover:border-corporate-gold/40 transition-colors duration-300 cursor-pointer",style:{animationDelay:`${S*100+T*50}ms`,animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsx("div",{className:"font-medium text-sm text-corporate-gold truncate",children:p.name}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[(U=p.brand)==null?void 0:U.name," • ",(Sr=p.model)==null?void 0:Sr.name]}),p.system&&e.jsxs("div",{className:"text-xs text-corporate-warm mt-1 truncate",children:["System: ",p.system.name]})]})}),e.jsx(v,{children:e.jsx("p",{children:"Device with active/in-progress tickets"})})]},p.id)}):e.jsx("div",{className:"text-sm text-muted-foreground italic p-3 text-center bg-corporate-gold/5 rounded-lg border border-corporate-gold/20",children:"No active device assignments"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nr,{className:"w-5 h-5 text-corporate-gold"}),e.jsx("h4",{className:"font-semibold text-lg text-corporate-gold dark:text-corporate-gold-light",children:"Recent Completed Tickets"})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>g(s,"recent"),className:"text-xs border-corporate-gold/30 hover:bg-primary hover:text-white",children:[e.jsx(Es,{className:"w-3 h-3 mr-1"}),"View All Recent"]})}),e.jsx(v,{children:e.jsx("p",{children:"View tickets from last 7 days"})})]})]}),e.jsx("div",{className:"space-y-2 max-h-44 overflow-y-auto scrollbar-thin",children:((h=s.tickets)==null?void 0:h.filter(p=>{const T=new Date;return T.setDate(T.getDate()-7),T.setHours(0,0,0,0),new Date(p.created_at)>=T&&["resolved","closed"].includes(p.status)}).length)>0?s.tickets.filter(p=>{const T=new Date;return T.setDate(T.getDate()-7),T.setHours(0,0,0,0),new Date(p.created_at)>=T&&["resolved","closed"].includes(p.status)}).slice(0,5).map((p,T)=>e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{onClick:()=>y(p.id),className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 p-3 rounded-lg border border-corporate-gold/20 hover:bg-gradient-to-r hover:from-corporate-gold/10 hover:to-corporate-warm/10 hover:border-corporate-gold/40 transition-all duration-300 cursor-pointer hover:scale-105 transform group",style:{animationDelay:`${S*100+T*50}ms`,animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-sm truncate pr-2 text-corporate-gold group-hover:text-corporate-warm",children:p.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium transition-all duration-300 flex-shrink-0 ${C(p.status)}`,children:p.status.replace("_"," ")}),e.jsx(Pr,{className:"w-3 h-3 text-corporate-gold opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 truncate",children:[k(p.created_at),p.building&&e.jsxs("span",{className:"ml-2 text-corporate-warm",children:["• ",p.building.name]})]}),p.device&&e.jsxs("div",{className:"text-xs text-corporate-gold mt-1 truncate",children:["Device: ",p.device.name]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Click to view ticket details and history"}),e.jsx("p",{className:"text-green-500",children:"✓ Completed ticket"}),e.jsxs("p",{children:["Status: ",p.status]})]})]},p.id)):e.jsxs("div",{className:"text-sm text-muted-foreground italic p-3 text-center bg-corporate-gold/5 rounded-lg border border-corporate-gold/20",children:[e.jsx(nr,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{children:"No recent completed tickets"}),e.jsx("p",{className:"text-xs mt-1",children:"Last 7 days show no resolved/closed tickets"})]})})]})]})]})})]})]},s.id)})})}),We=async r=>{le(r.id);try{await ne.put(te("technicals.update-status",r.id),{},{preserveScroll:!0,onSuccess:()=>E.success("Status updated"),onError:()=>E.error("Error updating status")})}finally{le(null)}},Je=async r=>{if(!x){E.error("Only super-admin can manage Tech Defaults");return}try{await ne.put(te("technicals.set-default",r.id),{},{preserveScroll:!0,onSuccess:()=>{const s=c(r)?"removed from":"assigned as";E.success(`Technical ${s} Tech Default successfully`)},onError:()=>E.error("Error updating Tech Default status")})}catch{E.error("Connection error")}},Xe=r=>{const s={id:r.id,name:r.name,email:r.email,phone:r.phone,shift:r.shift,photo:null};re(s),_e(s),z(r),be(!1),w(!0)},er=r=>{z(r),R(!0)},rr=async r=>{try{ne.put(te("technicals.reset-password",r.id),{},{preserveScroll:!0,onSuccess:()=>{E.success(`Password reset for ${r.name}. New password is their email: ${r.email}`)},onError:s=>{console.error("Reset password errors:",s),s.error?E.error(s.error):Object.values(s).forEach(S=>E.error(S))}})}catch(s){console.error("Reset password error:",s),E.error("Error resetting password")}},es=r=>{br(r),Te({instruction:"",priority:"normal"}),Se(!0)},rs=async r=>{if(r.preventDefault(),!B||!ee.instruction.trim()){E.error("Please enter an instruction");return}vr(!0);try{await ne.post(te("technicals.send-instruction",B.id),{instruction:ee.instruction,priority:ee.priority},{preserveScroll:!0,onSuccess:()=>{Se(!1),br(null),Te({instruction:"",priority:"normal"}),E.success("Instruction sent successfully")},onError:s=>{Object.values(s).forEach(S=>E.error(S))}})}catch{E.error("Error sending instruction")}finally{vr(!1)}},ss=r=>{switch(r){case"low":return"bg-blue-100 text-blue-800";case"normal":return"bg-gray-100 text-gray-800";case"high":return"bg-orange-100 text-orange-800";case"urgent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ts=r=>{if(r.preventDefault(),L.id){const s=new FormData;s.append("_method","PUT"),Object.entries(L).forEach(([S,u])=>{u!==null&&(typeof u=="number"?s.append(S,u.toString()):s.append(S,u))}),ne.post(te("technicals.update",L.id),s,{preserveScroll:!0,onSuccess:()=>{$e(),E.success("Technical updated")},onError:S=>{Object.values(S).forEach(u=>E.error(u))}})}else{const s={name:L.name,email:L.email,phone:L.phone,shift:L.shift,photo:L.photo};ne.post(te("technicals.store"),s,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{$e(),E.success("Technical created")},onError:S=>{Object.values(S).forEach(u=>E.error(u))}})}},as=()=>{P&&Yr(te("technicals.destroy",P.id),{preserveScroll:!0,onSuccess:()=>{R(!1),E.success("Technical deleted")},onError:()=>{E.error("Delete failed")}})};return e.jsxs(ls,{children:[e.jsx(ms,{title:"Technicals Management"}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
                @keyframes fadeInUp {
                    from {
                        opacity: 0;
                        transform: translateY(30px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                @keyframes bounceIn {
                    0% {
                        opacity: 0;
                        transform: scale(0.3);
                    }
                    50% {
                        opacity: 1;
                        transform: scale(1.05);
                    }
                    70% {
                        transform: scale(0.9);
                    }
                    100% {
                        opacity: 1;
                        transform: scale(1);
                    }
                }
                
                @keyframes shimmer {
                    0% {
                        background-position: -200px 0;
                    }
                    100% {
                        background-position: calc(200px + 100%) 0;
                    }
                }
                
                .animate-fadeInUp {
                    animation: fadeInUp 0.6s ease-out;
                }
                
                .animate-bounceIn {
                    animation: bounceIn 0.8s ease-out;
                }
                
                .animate-shimmer {
                    background: linear-gradient(
                        90deg,
                        transparent,
                        rgba(255, 255, 255, 0.2),
                        transparent
                    );
                    background-size: 200px 100%;
                    animation: shimmer 2s infinite;
                }
                
                .scrollbar-thin {
                    scrollbar-width: thin;
                }
                
                .scrollbar-thin::-webkit-scrollbar {
                    width: 4px;
                    height: 4px;
                }
                
                .scrollbar-thin::-webkit-scrollbar-track {
                    background: transparent;
                }
                
                .scrollbar-thin::-webkit-scrollbar-thumb {
                    background-color: rgba(156, 163, 175, 0.2);
                    border-radius: 2px;
                }
                
                .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                    background-color: rgba(156, 163, 175, 0.3);
                }
            `}}),e.jsxs("div",{className:"bg-gradient-to-br from-corporate-gold/10 via-corporate-warm/10 to-corporate-gold/5 dark:from-corporate-gold/20 dark:via-corporate-warm/20 dark:to-corporate-gold/10 p-6 border-b border-corporate-gold/20",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-primary to-accent rounded-xl shadow-lg",children:e.jsx($r,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-corporate-gold dark:text-corporate-gold-light",children:"Technical Team Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage technical staff, track performance, and monitor ticket assignments"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsx(Re,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-green-200",children:e.jsx(Pe,{className:"p-3",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2 cursor-help",children:[e.jsx(ir,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Active Technicals"}),e.jsx("p",{className:"text-xl font-bold text-green-700",children:e.jsx(M,{value:o.data.filter(r=>r.status).length})})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Currently active technicals"}),e.jsx("p",{children:"Ready to handle tickets and assignments"})]})]})})}),e.jsx(Re,{className:"bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 border-corporate-gold/30",children:e.jsx(Pe,{className:"p-3",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2 cursor-help",children:[e.jsx(Ce,{className:"w-5 h-5 text-corporate-gold"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-corporate-gold",children:"Tech Defaults"}),e.jsx("p",{className:"text-xl font-bold text-corporate-gold",children:e.jsx(M,{value:o.data.filter(r=>r.is_default).length})})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Technical Chiefs - Team Leaders"}),e.jsx("p",{children:"Have additional permissions and responsibilities"}),e.jsx("p",{className:"text-corporate-gold",children:"Only super-admin can assign this role"})]})]})})}),e.jsx(Re,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 border-blue-200",children:e.jsx(Pe,{className:"p-3",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2 cursor-help",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Tickets"}),e.jsx("p",{className:"text-xl font-bold text-blue-700",children:e.jsx(M,{value:o.data.reduce((r,s)=>r+s.total_tickets,0)})})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Total tickets handled by all technicals"}),e.jsx("p",{children:"Includes all statuses across the team"})]})]})})}),e.jsx(Re,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 border-purple-200",children:e.jsx(Pe,{className:"p-3",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2 cursor-help",children:[e.jsx(ys,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Avg Resolution"}),e.jsxs("p",{className:"text-xl font-bold text-purple-700",children:[e.jsx(M,{value:Math.round(o.data.reduce((r,s)=>r+s.avg_resolution_time,0)/o.data.length)||0}),"h"]})]})]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Average resolution time across all technicals"}),e.jsx("p",{children:"Time from ticket creation to resolution"}),e.jsx("p",{className:"text-purple-500",children:"Lower values indicate better efficiency"})]})]})})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{variant:"outline",onClick:()=>qr(!pr),className:"border-corporate-gold/30 hover:bg-corporate-gold hover:text-primary-foreground transition-all duration-300",children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Advanced Filters"]})}),e.jsxs(v,{children:[e.jsx("p",{children:"Advanced search and filtering options"}),e.jsx("p",{children:"Filter by status, shift, and search terms"})]})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{onClick:()=>{const r={id:null,name:"",email:"",phone:"",shift:"morning",photo:null};re(r),_e(r),z(null),be(!1),w(!0)},className:"text-primary-foreground bg-primary hover:from-corporate-warm hover:to-corporate-gold  shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(Er,{className:"mr-2 h-4 w-4"}),"Add New Technical"]})}),e.jsx(v,{children:e.jsx("p",{children:"Add a new technical staff member"})})]})]})]}),pr&&e.jsxs("div",{className:"mt-6 p-4 bg-white dark:bg-gray-800 rounded-xl border border-corporate-gold/20 shadow-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"search",className:"text-sm font-medium text-corporate-gold",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Ae,{id:"search",placeholder:"Search by name, email, or phone...",value:J,onChange:r=>Be(r.target.value),className:"pl-10 border-corporate-gold/20 focus:border-corporate-gold"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium text-corporate-gold",children:"Status"}),e.jsxs(Ne,{value:X,onValueChange:Qe,children:[e.jsx(we,{className:"border-corporate-gold/20 focus:border-corporate-gold",children:e.jsx(ye,{placeholder:"All Status"})}),e.jsxs(ke,{children:[e.jsx(F,{value:"all",children:"All Status"}),e.jsx(F,{value:"active",children:"Active Only"}),e.jsx(F,{value:"inactive",children:"Inactive Only"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium text-corporate-gold",children:"Shift"}),e.jsxs(Ne,{value:ie,onValueChange:Ge,children:[e.jsx(we,{className:"border-corporate-gold/20 focus:border-corporate-gold",children:e.jsx(ye,{placeholder:"All Shifts"})}),e.jsxs(ke,{children:[e.jsx(F,{value:"all",children:"All Shifts"}),e.jsx(F,{value:"morning",children:"Morning"}),e.jsx(F,{value:"afternoon",children:"Afternoon"}),e.jsx(F,{value:"night",children:"Night"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium text-corporate-gold",children:"View Mode"}),e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 p-1 rounded-lg",children:[e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>D("list"),className:`flex-1 ${d==="list"?"bg-white dark:bg-gray-600 shadow-sm":""}`,children:e.jsx(bs,{className:"w-4 h-4 mr-1"})})}),e.jsx(v,{children:e.jsx("p",{children:"Detailed List View - Comprehensive View"})})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>D("grid"),className:`flex-1 ${d==="grid"?"bg-white dark:bg-gray-600 shadow-sm":""}`,children:e.jsx(vs,{className:"w-4 h-4 mr-1"})})}),e.jsx(v,{children:e.jsx("p",{children:"Grid Cards View - Quick Overview"})})]}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>D("table"),className:`flex-1 ${d==="table"?"bg-white dark:bg-gray-600 shadow-sm":""}`,children:e.jsx(Ds,{className:"w-4 h-4 mr-1"})})}),e.jsx(v,{children:e.jsx("p",{children:"Data Table View - Traditional Layout"})})]})]})]})]}),(J||X!=="all"||ie!=="all")&&e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),J&&e.jsxs(Ee,{variant:"secondary",className:"bg-corporate-gold/10 text-corporate-gold",children:["Search: ",J]}),X!=="all"&&e.jsxs(Ee,{variant:"secondary",className:"bg-corporate-gold/10 text-corporate-gold",children:["Status: ",X]}),ie!=="all"&&e.jsxs(Ee,{variant:"secondary",className:"bg-corporate-gold/10 text-corporate-gold",children:["Shift: ",ie]}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>{Be(""),Qe("all"),Ge("all")},className:"h-6 px-2 text-xs text-muted-foreground hover:text-corporate-gold",children:"Clear all"})]})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[d==="grid"&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grid columns:"}),e.jsxs(Ne,{value:ge.toString(),onValueChange:r=>fe(Number(r)),children:[e.jsx(we,{className:"w-24 h-8",children:e.jsx(ye,{})}),e.jsx(ke,{children:[2,3,4,5,6].map(r=>e.jsx(F,{value:r.toString(),children:r},r))})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",je.length," of ",o.data.length," technicals"]})]}),je.length===0?e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"animate-bounceIn",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 rounded-full flex items-center justify-center mx-auto mb-6 border-4 border-corporate-gold/30",children:e.jsx($r,{className:"w-16 h-16 text-corporate-gold"})}),e.jsx("h3",{className:"text-2xl font-bold text-corporate-gold mb-4",children:o.data.length===0?"No Technicals Yet":"No Results Found"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:o.data.length===0?"Start building your technical team by adding your first technical staff member.":"Try adjusting your search criteria or filters to find the technicals you're looking for."}),o.data.length===0?e.jsxs(O,{onClick:()=>{const r={id:null,name:"",email:"",phone:"",shift:"morning",photo:null};re(r),_e(r),z(null),be(!1),w(!0)},className:"bg-gradient-to-r from-corporate-gold to-corporate-warm hover:from-corporate-warm hover:to-corporate-gold text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(Er,{className:"mr-2 h-4 w-4"}),"Add Your First Technical"]}):e.jsxs(O,{variant:"outline",onClick:()=>{Be(""),Qe("all"),Ge("all")},className:"border-corporate-gold/30 hover:bg-corporate-gold hover:text-white",children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),"Clear All Filters"]})]})}):d==="list"?e.jsx(Xr,{technicals:je}):d==="grid"?e.jsx(Jr,{technicals:je,gridColumns:ge}):e.jsx(or,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(xs,{children:[e.jsx(us,{children:Ze.getHeaderGroups().map(r=>e.jsx(tr,{children:r.headers.map(s=>e.jsx(ps,{children:Or(s.column.columnDef.header,s.getContext())},s.id))},r.id))}),e.jsx(gs,{children:(Cr=Ze.getRowModel().rows)!=null&&Cr.length?Ze.getRowModel().rows.map(r=>e.jsx(tr,{children:r.getVisibleCells().map(s=>e.jsx(_r,{children:Or(s.column.columnDef.cell,s.getContext())},s.id))},r.id)):e.jsx(tr,{children:e.jsx(_r,{colSpan:yr.length,className:"h-24 text-center",children:"No results."})})})]})})}),e.jsx(ce,{open:$,onOpenChange:wr,children:e.jsxs(de,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(me,{className:"flex-shrink-0",children:e.jsx(he,{children:P?"Edit Technical":"New Technical"})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 -mr-2 space-y-4 scrollbar-thin scrollbar-thumb-corporate-gold/20 scrollbar-track-transparent hover:scrollbar-thumb-corporate-gold/40 dark:scrollbar-thumb-corporate-gold-light/20 dark:hover:scrollbar-thumb-corporate-gold-light/40",children:e.jsxs("form",{onSubmit:ts,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:" space-y-2",children:[e.jsx(V,{children:"Photo"}),e.jsxs("div",{className:"mt-2 group relative w-full aspect-square rounded-lg overflow-hidden border-2 border-dashed bg-muted/50",children:[e.jsx("input",{type:"file",onChange:r=>{var s;return ve("photo",((s=r.target.files)==null?void 0:s[0])||null)},className:"hidden",id:"photo-upload"}),e.jsx("label",{htmlFor:"photo-upload",className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",children:L.photo?e.jsx("img",{src:URL.createObjectURL(L.photo),alt:"Preview",className:"w-full h-full object-cover"}):P&&K(P.photo)?e.jsx("img",{src:K(P.photo),alt:"Current",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(ue,{className:"w-12 h-12 mx-auto text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload photo"})]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Name"}),e.jsx(Ae,{value:L.name,onChange:r=>ve("name",r.target.value),required:!0,className:"h-11 mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Email"}),e.jsx(Ae,{type:"email",value:L.email,onChange:r=>ve("email",r.target.value),required:!0,className:"h-11 mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Phone"}),e.jsx(Ae,{value:L.phone,onChange:r=>ve("phone",r.target.value),required:!0,className:"h-11 mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Shift"}),e.jsxs(Ne,{value:L.shift,onValueChange:r=>ve("shift",r),children:[e.jsx(we,{className:"h-11 mt-2",children:e.jsx(ye,{placeholder:"Select shift"})}),e.jsxs(ke,{children:[e.jsx(F,{value:"morning",children:"Morning"}),e.jsx(F,{value:"afternoon",children:"Afternoon"}),e.jsx(F,{value:"night",children:"Night"})]})]})]})]})]}),e.jsxs(xe,{className:"flex-shrink-0 pt-4",children:[e.jsx(O,{type:"button",variant:"outline",onClick:wr,children:"Cancel"}),e.jsx(O,{type:"submit",disabled:Nr,children:Nr?"Saving...":"Save"})]})]})})]})}),e.jsx(ce,{open:Kr,onOpenChange:Oe,children:e.jsxs(de,{className:"sm:max-w-md",children:[e.jsx(me,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/20 flex items-center justify-center flex-shrink-0",children:e.jsx(cr,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx(he,{children:"Unsaved Changes"}),e.jsx(lr,{className:"mt-1",children:"You have unsaved changes that will be lost if you close this dialog."})]})]})}),e.jsxs(xe,{className:"gap-2 sm:gap-0",children:[e.jsx(O,{variant:"outline",onClick:()=>Oe(!1),className:"w-full sm:w-auto",children:"Continue Editing"}),e.jsx(O,{variant:"destructive",onClick:Wr,className:"w-full sm:w-auto",children:"Discard Changes"})]})]})}),e.jsx(ce,{open:_,onOpenChange:R,children:e.jsxs(de,{children:[e.jsxs(me,{children:[e.jsx(he,{children:"Confirm Delete"}),e.jsxs(lr,{children:["Are you sure you want to delete ",P==null?void 0:P.name,"?"]})]}),e.jsxs(xe,{children:[e.jsx(O,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsx(O,{variant:"destructive",onClick:as,children:"Delete"})]})]})}),e.jsx(ce,{open:G,onOpenChange:oe,children:e.jsxs(de,{className:"sm:max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(me,{className:"flex-shrink-0 pb-4 border-b border-corporate-gold/20",children:e.jsxs(he,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-corporate-gold to-corporate-warm rounded-lg",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-corporate-gold",children:Hr}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:fr?"Loading tickets...":`${W.length} tickets found`})]}),e.jsx("div",{className:"ml-auto",children:e.jsxs(Ee,{variant:"secondary",className:"bg-corporate-gold/10 text-corporate-gold border-corporate-gold/30",children:[W.length," total"]})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 -mr-2 scrollbar-thin scrollbar-thumb-corporate-gold/20 scrollbar-track-transparent hover:scrollbar-thumb-corporate-gold/40",children:fr?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-corporate-gold mb-4"}),e.jsx("p",{className:"text-lg font-medium text-corporate-gold",children:"Loading tickets..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we fetch the latest data"})]}):W.length>0?e.jsx("div",{className:"space-y-3",children:W.map((r,s)=>e.jsx("div",{onClick:()=>y(r.id),className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 p-4 rounded-lg border border-corporate-gold/20 hover:bg-gradient-to-r hover:from-corporate-gold/10 hover:to-corporate-warm/10 hover:border-corporate-gold/40 transition-all duration-300 cursor-pointer  transform group",style:{animationDelay:`${s*100}ms`,animation:"fadeInUp 0.6s ease-out forwards"},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg text-corporate-gold group-hover:text-corporate-warm transition-colors duration-300 truncate",children:["#",r.id," - ",r.title]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${C(r.status)}`,children:r.status.replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ar,{className:"w-4 h-4 text-corporate-gold"}),e.jsxs("span",{children:["Created: ",k(r.created_at)]})]}),r.building&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rr,{className:"w-4 h-4 text-corporate-warm"}),e.jsx("span",{children:r.building.name})]}),r.device&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-corporate-gold"}),e.jsx("span",{children:r.device.name})]}),r.priority&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cr,{className:`w-4 h-4 ${r.priority==="urgent"?"text-red-500":r.priority==="high"?"text-orange-500":r.priority==="medium"?"text-yellow-500":"text-green-500"}`}),e.jsxs("span",{className:"capitalize",children:[r.priority," Priority"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-4",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsx(O,{variant:"outline",size:"sm",onClick:()=>y(r.id),className:"border-corporate-gold/30 hover:bg-primary hover:text-white",children:e.jsx(Pr,{className:"w-4 h-4"})})}),e.jsx(v,{children:e.jsx("p",{children:"Open full ticket detail"})})]})})]})},r.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-corporate-gold/20 to-corporate-warm/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Me,{className:"w-12 h-12 text-corporate-gold"})}),e.jsx("h3",{className:"text-xl font-bold text-corporate-gold mb-2",children:"No tickets found"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"This technical has no tickets for the selected filter. Try a different filter or check back later."})]})}),e.jsx(xe,{className:"flex-shrink-0 pt-4",children:e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:W.length>0&&e.jsxs("span",{children:["Showing ",W.length," ticket",W.length!==1?"s":""]})}),e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{variant:"outline",onClick:()=>oe(!1),children:[e.jsx(Mr,{className:"w-4 h-4 mr-1"}),"Close"]})}),e.jsx(v,{children:e.jsx("p",{children:"Close ticket list modal"})})]})]})})]})}),e.jsx(ce,{open:He,onOpenChange:Z,children:e.jsxs(de,{className:"sm:max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(me,{className:"flex-shrink-0 pb-6 border-b border-corporate-gold/20",children:e.jsxs(he,{className:"flex items-center gap-3 text-xl font-bold",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-corporate-gold to-corporate-warm rounded-lg",children:e.jsx(Me,{className:"w-6 h-6 text-white"})}),"Ticket Details"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 -mr-2 scrollbar-thin scrollbar-thumb-corporate-gold/20 scrollbar-track-transparent hover:scrollbar-thumb-corporate-gold/40",children:Br?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-corporate-gold mb-4"}),e.jsx("p",{className:"text-lg font-medium text-corporate-gold",children:"Loading ticket details..."})]}):f?e.jsxs("div",{className:"px-6 pb-6",children:[f.user&&f.user.tenant&&e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:f.user.tenant.photo?e.jsx("img",{src:f.user.tenant.photo.startsWith("http")?f.user.tenant.photo:`/storage/${f.user.tenant.photo}`,alt:f.user.tenant.name,className:"w-12 h-12 rounded-full border-2 border-purple-300 shadow-md object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-blue-400 flex items-center justify-center text-white text-sm font-bold",children:((Dr=f.user.tenant.name)==null?void 0:Dr.substring(0,1))||"?"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(ue,{className:"w-3 h-3 text-purple-600"}),e.jsx("p",{className:"text-sm font-semibold text-purple-900 truncate",children:f.user.tenant.name})]}),f.user.tenant.email&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Ss,{className:"w-3 h-3 text-green-600"}),e.jsx("p",{className:"text-xs text-green-800 truncate",children:f.user.tenant.email})]}),f.user.tenant.phone&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Ts,{className:"w-3 h-3 text-orange-600"}),e.jsx("p",{className:"text-xs text-orange-800 truncate",children:f.user.tenant.phone})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:f.title}),e.jsx("span",{className:`px-3 py-1.5 rounded-full text-xs font-medium ${C(f.status)}`,children:f.status.replace("_"," ")})]}),e.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:f.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"ID:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["#",f.id]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Category:"}),e.jsx("span",{className:"ml-2 font-medium",children:f.category})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[f.device&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md bg-sky-100 text-sky-700 text-xs font-medium",children:[e.jsx(Ie,{className:"w-3 h-3"}),f.device.name||"Device"]}),e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md bg-purple-100 text-purple-700 text-xs font-medium",children:[e.jsx(Ns,{className:"w-3 h-3"}),f.category]})]})}),e.jsxs("div",{className:"text-xs text-slate-500 space-y-1 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-3 h-3"}),"Created: ",k(f.created_at)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"w-3 h-3"}),"Updated: ",k(f.updated_at)]}),f.resolved_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ir,{className:"w-3 h-3"}),"Resolved: ",k(f.resolved_at)]})]}),(f.building||f.device)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[f.building&&e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-3 rounded-lg border",children:[e.jsxs("h4",{className:"font-medium text-sm text-corporate-gold mb-1 flex items-center gap-1",children:[e.jsx(Rr,{className:"w-3 h-3"}),"Building"]}),e.jsx("p",{className:"text-sm",children:f.building.name}),f.building.address&&e.jsx("p",{className:"text-xs text-muted-foreground",children:f.building.address})]}),f.device&&e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-3 rounded-lg border",children:[e.jsxs("h4",{className:"font-medium text-sm text-corporate-gold mb-1 flex items-center gap-1",children:[e.jsx(Ie,{className:"w-3 h-3"}),"Device Details"]}),e.jsx("p",{className:"text-sm",children:f.device.name}),f.device.brand&&e.jsx("p",{className:"text-xs text-muted-foreground",children:f.device.brand.name})]})]})]}),e.jsx("div",{className:"border-t border-slate-200 my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-medium text-slate-900 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-blue-500"}),"History"]}),e.jsx("div",{className:"space-y-3",children:!f.history||f.history.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-500",children:[e.jsx(Fe,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm",children:"No history available"})]}):[...f.history].slice().reverse().map((r,s,S)=>e.jsxs("div",{className:"relative pl-6 pb-4 last:pb-0",children:[e.jsx("div",{className:"absolute left-0 top-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow"}),s!==S.length-1&&e.jsx("div",{className:"absolute left-1.5 top-4 w-0.5 h-full bg-slate-200"}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 ml-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:r.action.replace("_"," ")}),s===0&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Recent"})]}),e.jsx("p",{className:"text-sm text-slate-700 mb-2",children:r.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),r.user?r.user.name:"System"]}),e.jsx("span",{children:k(r.created_at)})]})]})]},r.id))})]}),f.resolution_time&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200 mt-6",children:[e.jsxs("h3",{className:"font-semibold text-lg text-green-600 mb-2 flex items-center gap-2",children:[e.jsx(Os,{className:"w-5 h-5"}),"Resolution Metrics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resolution Time:"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[f.resolution_time,"h"]})]}),f.rating&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rating:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((r,s)=>e.jsx(_s,{className:`w-4 h-4 ${s<f.rating?"text-yellow-400 fill-current":"text-gray-300"}`},s)),e.jsxs("span",{className:"ml-1 font-bold text-yellow-600",children:["(",f.rating,"/5)"]})]})]}),f.feedback&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Feedback:"}),e.jsxs("p",{className:"text-sm text-muted-foreground italic",children:['"',f.feedback,'"']})]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(cr,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Error loading ticket details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]})}),e.jsx(xe,{className:"flex-shrink-0 pt-4 border-t border-corporate-gold/20",children:e.jsxs(j,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(O,{variant:"outline",onClick:()=>{Z(!1),qe(null)},className:"px-6 py-2.5",children:[e.jsx(Mr,{className:"w-4 h-4 mr-1"}),"Back to List"]})}),e.jsx(v,{children:e.jsx("p",{children:"Return to ticket list"})})]})})]})}),e.jsx(ce,{open:Qr,onOpenChange:Se,children:e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsxs(me,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-blue-500"}),"Send Instruction to ",B==null?void 0:B.name]}),e.jsx(lr,{children:"Send instructions or guidelines to the technical. Choose priority level appropriately."})]}),e.jsxs("form",{onSubmit:rs,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"priority",children:"Priority Level"}),e.jsxs(Ne,{value:ee.priority,onValueChange:r=>Te(s=>({...s,priority:r})),children:[e.jsx(we,{children:e.jsx(ye,{})}),e.jsxs(ke,{children:[e.jsx(F,{value:"low",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Low Priority"]})}),e.jsx(F,{value:"normal",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-500"}),"Normal Priority"]})}),e.jsx(F,{value:"high",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),"High Priority"]})}),e.jsx(F,{value:"urgent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),"URGENT"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"instruction",children:"Instruction"}),e.jsx("textarea",{id:"instruction",value:ee.instruction,onChange:r=>Te(s=>({...s,instruction:r.target.value})),placeholder:"Enter your instruction or message for the technical...",className:"min-h-[120px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",maxLength:1e3,required:!0}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[ee.instruction.length,"/1000 characters"]})]}),(B==null?void 0:B.instructions)&&B.instructions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Recent Instructions (last 3)"}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-2 p-2 border rounded-md bg-gray-50",children:B.instructions.slice(0,3).map((r,s)=>e.jsxs("div",{className:"text-xs border-l-2 border-gray-300 pl-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${ss(r.priority)}`,children:r.priority.toUpperCase()}),e.jsxs("span",{className:"text-gray-500",children:["from ",r.from]}),e.jsx("span",{className:"text-gray-400",children:new Date(r.sent_at).toLocaleDateString()})]}),e.jsx("p",{className:"mt-1 text-gray-700",children:r.instruction})]},s))})]}),e.jsxs(xe,{children:[e.jsx(O,{type:"button",variant:"outline",onClick:()=>Se(!1),disabled:Ke,children:"Cancel"}),e.jsx(O,{type:"submit",disabled:Ke||!ee.instruction.trim(),className:"bg-blue-600 hover:bg-blue-700",children:Ke?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Send Instruction"]})})]})]})]})})]})]})}const Gs=({status:o})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o==="active"?"Active":"Inactive"});export{Lt as default};
