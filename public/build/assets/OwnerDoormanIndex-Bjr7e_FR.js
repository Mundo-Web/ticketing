import{j as e}from"./ui--9QRf85z.js";import{A as I}from"./app-layout-FZgN8WaO.js";import{m as E,L as q}from"./app-Dqfm4jeq.js";import{C as j,c as f}from"./card-DuB4YgHF.js";import{B as m}from"./button-3fVzTxZH.js";import{B as A}from"./badge-CTYXlqUe.js";import{I as g}from"./input-0DEeXnQl.js";import{r as x}from"./recharts-B16uQ_Zp.js";import{D as M,a as U,b as V,c as H,e as $,g as z}from"./dialog-Gizu_HUr.js";import{L as c}from"./label-B8HdVDlN.js";import{T as F}from"./textarea-xkRJ1FGY.js";import{S as v,a as N,b as C,c as w,d as y}from"./select-BeaewNmC.js";import{B as G}from"./building-2-Dm3FgcsS.js";import{S as K}from"./search-BYwieh_P.js";import{U as R}from"./user-B9S7Zak9.js";import{c as J}from"./x-Dwbvy68c.js";import{T as P}from"./ticket-NZxvcyxK.js";import"./index--i9LXxpm.js";import"./utils-DvwAYYBZ.js";import"./tooltip-Dm-vk6MS.js";import"./check-C_IBZmq_.js";import"./createLucideIcon-BBA9I-xQ.js";import"./index-BDFBH7XS.js";import"./index-BsIecJEN.js";import"./index-Df3HipqK.js";import"./chevrons-up-down-DaqTssCh.js";import"./circle-check-big-DKZvEq1H.js";import"./react-B1hewrmX.js";const Q=["Hardware","Software","Conectividad","Otro"];function De({building:o,members:S,devices:W,userRole:h}){var u;const[n,D]=x.useState(""),[t,p]=x.useState(null),[T,d]=x.useState(!1),{data:l,setData:i,post:b,processing:L,errors:r,reset:k}=E({device_id:"",category:"",title:"",description:"",member_id:""}),_=s=>{s.preventDefault(),b("/tickets",{preserveScroll:!0,onSuccess:()=>{d(!1),k(),p(null)}})},O=S.filter(s=>{var a;return s.name.toLowerCase().includes(n.toLowerCase())||s.email.toLowerCase().includes(n.toLowerCase())||((a=s.apartment)==null?void 0:a.name.toLowerCase().includes(n.toLowerCase()))});t!=null&&t.devices;const B=[{title:"Dashboard",href:"/dashboard"},{title:"Devices & Members",href:"#"}];return e.jsxs(I,{breadcrumbs:B,children:[e.jsx(q,{title:`Device Management - ${h==="owner"?"Owner":"Doorman"}`}),e.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Device & Member Management"}),e.jsxs("p",{className:"text-muted-foreground",children:["Manage devices and create tickets for members in ",o.name]})]}),e.jsx(A,{variant:"outline",className:"bg-primary/10 text-primary",children:h==="owner"?"Owner":"Doorman"})]}),e.jsx(j,{children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/20 flex items-center justify-center",children:e.jsx(G,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:o.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.address})]})]})})}),e.jsxs("div",{className:"relative w-full sm:w-96",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search members...",className:"pl-9 w-full",value:n,onChange:s=>D(s.target.value)})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map(s=>{var a;return e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsxs(f,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-secondary/20 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-foreground truncate",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email}),s.apartment&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Apt: ",s.apartment.name]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[((a=s.devices)==null?void 0:a.length)||0," devices"]})]}),e.jsxs(m,{size:"sm",onClick:()=>{p(s),i("member_id",s.id.toString()),d(!0)},className:"bg-primary hover:bg-primary/90",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"Create Ticket"]})]})]})},s.id)})}),e.jsx(M,{open:T,onOpenChange:d,children:e.jsxs(U,{children:[e.jsx(V,{children:e.jsxs(H,{children:["Create Ticket for ",t==null?void 0:t.name]})}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Device"}),e.jsxs(v,{value:l.device_id,onValueChange:s=>i("device_id",s),required:!0,children:[e.jsx(N,{children:e.jsx(C,{placeholder:"Select a device"})}),e.jsx(w,{children:(u=t==null?void 0:t.devices)==null?void 0:u.map(s=>{var a;return e.jsxs(y,{value:String(s.id),children:[((a=s.name_device)==null?void 0:a.name)||s.name||"Unnamed Device",s.brand&&` - ${s.brand.name}`]},s.id)})})]}),r.device_id&&e.jsx("div",{className:"text-red-500 text-sm",children:r.device_id})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Category"}),e.jsxs(v,{value:l.category,onValueChange:s=>i("category",s),required:!0,children:[e.jsx(N,{children:e.jsx(C,{placeholder:"Select a category"})}),e.jsx(w,{children:Q.map(s=>e.jsx(y,{value:s,children:s},s))})]}),r.category&&e.jsx("div",{className:"text-red-500 text-sm",children:r.category})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Title"}),e.jsx(g,{type:"text",value:l.title,onChange:s=>i("title",s.target.value),required:!0}),r.title&&e.jsx("div",{className:"text-red-500 text-sm",children:r.title})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Description"}),e.jsx(F,{value:l.description,onChange:s=>i("description",s.target.value),required:!0}),r.description&&e.jsx("div",{className:"text-red-500 text-sm",children:r.description})]}),e.jsxs($,{children:[e.jsx(z,{asChild:!0,children:e.jsx(m,{type:"button",variant:"outline",children:"Cancel"})}),e.jsx(m,{type:"submit",disabled:L,children:"Create Ticket"})]})]})]})})]})]})}export{De as default};
