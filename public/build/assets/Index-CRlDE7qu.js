import{j as e}from"./ui-B_LlBPKL.js";import{r as h}from"./recharts-C_88tpBl.js";import{L as z,$ as P,S as d,t as o}from"./app-CDrFO_XK.js";import{C as S,b,c as k,d as A,a as _}from"./card-D2PMvY5E.js";import{T as W,a as G,b as j,c as t,d as K,e as i}from"./table-DH001fLy.js";import{B as r}from"./badge-D8qydIEn.js";import{B as u}from"./button-D7WChgOL.js";import{D as q,a as J,b as Q,e as U,d as p}from"./dropdown-menu-DMNoBHsR.js";import{I as X}from"./input-CPYfG3NN.js";import{S as D,a as E,b as B,c as I,d as n}from"./select-BW9itjM_.js";import{W as Y}from"./wifi-CRwhCiWI.js";import{S as Z}from"./search-Du8maFVh.js";import{f as M}from"./format-CCdy9gBC.js";import{T as F}from"./ticket-plus-DMc59eOu.js";import{E as ee}from"./ellipsis-Bcr1duWK.js";import{E as se}from"./eye-C0Ej2ac6.js";import{C as N}from"./circle-check-big-kRE2lEsQ.js";import{e as R}from"./es-uH15eYUh.js";import{T as v,C as ae}from"./triangle-alert-x0pEFkjL.js";import"./react-B1hewrmX.js";import"./utils-BJRzUxt3.js";import"./check-ei1vhWUY.js";import"./createLucideIcon-BiVfa5Ur.js";import"./chevron-up-RfB0QmaY.js";import"./en-US-Cx6CYfeS.js";const re=a=>{switch(a){case"critical":return e.jsxs(r,{variant:"destructive",className:"gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),"Crítico"]});case"warning":return e.jsxs(r,{variant:"secondary",className:"gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),"Advertencia"]});case"info":return e.jsxs(r,{variant:"outline",className:"gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),"Información"]});default:return e.jsx(r,{variant:"outline",children:a})}},ce=a=>{switch(a){case"open":return e.jsxs(r,{variant:"destructive",className:"gap-1",children:[e.jsx(ae,{className:"h-3 w-3"}),"Abierto"]});case"acknowledged":return e.jsxs(r,{variant:"secondary",className:"gap-1",children:[e.jsx(N,{className:"h-3 w-3"}),"Reconocido"]});case"resolved":return e.jsxs(r,{variant:"default",className:"gap-1",children:[e.jsx(N,{className:"h-3 w-3"}),"Resuelto"]});default:return e.jsx(r,{variant:"outline",children:a})}};function De({alerts:a,filters:c}){var w,C,y;const[g,H]=h.useState((c==null?void 0:c.search)||""),[x,L]=h.useState((c==null?void 0:c.severity)||"all"),[m,$]=h.useState((c==null?void 0:c.status)||"all"),f=()=>{d.get("/ninjaone-alerts",{search:g||void 0,severity:x==="all"?void 0:x,status:m==="all"?void 0:m})},V=async s=>{try{await d.post(`/ninjaone-alerts/${s}/acknowledge`),o.success("Alerta reconocida correctamente")}catch{o.error("Error al reconocer la alerta")}},O=async s=>{try{await d.post(`/ninjaone-alerts/${s}/create-ticket`),o.success("Ticket creado correctamente")}catch{o.error("Error al crear el ticket")}};return e.jsxs(e.Fragment,{children:[e.jsx(z,{title:"Alertas NinjaOne"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Alertas NinjaOne"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestiona las alertas de dispositivos sincronizados con NinjaOne"})]})}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Filtros de Alertas"]}),e.jsx(A,{children:"Filtra y busca alertas específicas"})]}),e.jsx(_,{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(X,{placeholder:"Buscar por título, descripción o dispositivo...",value:g,onChange:s=>H(s.target.value),className:"pl-8",onKeyPress:s=>s.key==="Enter"&&f()})]})}),e.jsxs(D,{value:x,onValueChange:L,children:[e.jsx(E,{className:"w-[180px]",children:e.jsx(B,{placeholder:"Severidad"})}),e.jsxs(I,{children:[e.jsx(n,{value:"all",children:"Todas las severidades"}),e.jsx(n,{value:"critical",children:"Crítico"}),e.jsx(n,{value:"warning",children:"Advertencia"}),e.jsx(n,{value:"info",children:"Información"})]})]}),e.jsxs(D,{value:m,onValueChange:$,children:[e.jsx(E,{className:"w-[180px]",children:e.jsx(B,{placeholder:"Estado"})}),e.jsxs(I,{children:[e.jsx(n,{value:"all",children:"Todos los estados"}),e.jsx(n,{value:"open",children:"Abierto"}),e.jsx(n,{value:"acknowledged",children:"Reconocido"}),e.jsx(n,{value:"resolved",children:"Resuelto"})]})]}),e.jsx(u,{onClick:f,children:"Buscar"})]})})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(k,{children:"Lista de Alertas"}),e.jsxs(A,{children:[((w=a==null?void 0:a.meta)==null?void 0:w.total)||0," alertas encontradas"]})]}),e.jsxs(_,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(W,{children:[e.jsx(G,{children:e.jsxs(j,{children:[e.jsx(t,{children:"Dispositivo"}),e.jsx(t,{children:"Título"}),e.jsx(t,{children:"Severidad"}),e.jsx(t,{children:"Estado"}),e.jsx(t,{children:"Tipo"}),e.jsx(t,{children:"Fecha"}),e.jsx(t,{children:"Ticket"}),e.jsx(t,{className:"text-right",children:"Acciones"})]})}),e.jsx(K,{children:!(a!=null&&a.data)||a.data.length===0?e.jsx(j,{children:e.jsx(i,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"No se encontraron alertas"})}):a.data.map(s=>{var l,T;return e.jsxs(j,{children:[e.jsxs(i,{children:[e.jsx("div",{className:"font-medium",children:((l=s.device)==null?void 0:l.name)||"Dispositivo no encontrado"}),((T=s.device)==null?void 0:T.ninjaone_device_id)&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",s.device.ninjaone_device_id]})]}),e.jsx(i,{children:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-medium truncate",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:s.description})]})}),e.jsx(i,{children:re(s.severity)}),e.jsx(i,{children:ce(s.status)}),e.jsx(i,{children:e.jsx(r,{variant:"outline",children:s.alert_type})}),e.jsxs(i,{children:[e.jsx("div",{className:"text-sm",children:M(new Date(s.created_at),"dd/MM/yyyy",{locale:R})}),e.jsx("div",{className:"text-xs text-muted-foreground",children:M(new Date(s.created_at),"HH:mm",{locale:R})})]}),e.jsx(i,{children:s.ticket_created?e.jsxs(r,{variant:"default",className:"gap-1",children:[e.jsx(F,{className:"h-3 w-3"}),"Creado"]}):e.jsx(r,{variant:"outline",children:"Sin ticket"})}),e.jsx(i,{className:"text-right",children:e.jsxs(q,{children:[e.jsx(J,{asChild:!0,children:e.jsxs(u,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Abrir menú"}),e.jsx(ee,{className:"h-4 w-4"})]})}),e.jsxs(Q,{align:"end",children:[e.jsx(U,{children:"Acciones"}),e.jsx(p,{asChild:!0,children:e.jsxs(P,{href:`/ninjaone-alerts/${s.id}`,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Ver detalles"]})}),s.status==="open"&&e.jsxs(p,{onClick:()=>V(s.id),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Reconocer"]}),!s.ticket_created&&e.jsxs(p,{onClick:()=>O(s.id),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Crear Ticket"]})]})]})})]},s.id)})})]})}),((C=a==null?void 0:a.meta)==null?void 0:C.last_page)&&a.meta.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",a.meta.from||0," a ",a.meta.to||0," de ",a.meta.total||0," resultados"]}),e.jsx("div",{className:"flex gap-2",children:(y=a.links)==null?void 0:y.map((s,l)=>e.jsx(u,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&d.get(s.url),disabled:!s.url,dangerouslySetInnerHTML:{__html:s.label}},l))})]})]})]})]})]})}export{De as default};
